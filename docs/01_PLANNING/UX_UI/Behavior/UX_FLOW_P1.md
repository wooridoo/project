# WOORIDO UX 플로우 - P1 Essential (필수 확장)

> **Purpose:** Demo 후 우선 구현할 필수 확장 플로우
> **Last Updated:** 2026-01-21
> **Status:** Draft
> **Phase:** P1 (Essential Extension)

---

## 개요

| 항목 | 값 |
|------|-----|
| 총 플로우 수 | 7개 |
| 도메인 | 인증, 챌린지, 알림, 금융, 시스템 |
| 우선순위 | Demo 후 우선 |

---

## 1. 인증 도메인 (Auth)

### 1.1 비밀번호 재설정 플로우

> **트리거:** 로그인 화면에서 "비밀번호 찾기" 클릭
> **연관 API:** `POST /auth/password/reset`, `PUT /auth/password/reset`

```mermaid
flowchart TD
    A[로그인 화면] --> B[비밀번호 찾기 링크]
    B --> C[이메일 입력 화면]
    C --> D[이메일 입력]
    D --> E[인증 요청 API]
    
    E --> F{이메일 존재?}
    F -->|No| G["등록되지 않은 이메일입니다"]
    G --> H[회원가입 유도]
    
    F -->|Yes| I[인증 코드 발송]
    I --> J["이메일로 인증 코드를 보냈습니다"]
    J --> K[인증 코드 입력 화면]
    K --> L[6자리 코드 입력]
    L --> M[코드 확인 API]
    
    M --> N{코드 유효?}
    N -->|No| O[코드 불일치 안내]
    O --> P{재시도 횟수?}
    P -->|<3회| K
    P -->|≥3회| Q[새 코드 요청 유도]
    Q --> I
    
    N -->|Yes| R[새 비밀번호 입력]
    R --> S[비밀번호 확인 입력]
    S --> T{유효성 검증}
    T -->|실패| U[규칙 안내]
    U --> R
    
    T -->|성공| V[비밀번호 변경 API]
    V --> W["비밀번호가 변경되었습니다" Toast]
    W --> X[로그인 화면으로 이동]
```

**비밀번호 규칙:**
| 규칙 | 값 |
|------|-----|
| 길이 | 8-20자 |
| 필수 조합 | 영문 + 숫자 + 특수문자 |
| 특수문자 | `!@#$%^&*()_+-=[]{}|;:,.<>?` |

---

## 2. 챌린지 도메인 (Challenge)

### 2.1 리더 탄핵(LEADER_KICK) 플로우

> **트리거:** 팔로워가 리더 교체 투표 발의
> **연관 API:** `POST /challenges/{id}/votes` (type: LEADER_KICK)

```mermaid
flowchart TD
    A[설정 > 리더 교체 요청] --> B{요청자 역할?}
    B -->|리더| C["리더는 요청 불가" 안내]
    C --> D[권한 위임 유도]
    
    B -->|팔로워| E[리더 교체 사유 입력]
    E --> F["⚠️ 팔로워 70% 승인 필요" 경고]
    F --> G["현 리더는 투표 참여 불가"]
    G --> H{계속?}
    H -->|No| I[취소]
    
    H -->|Yes| J[LEADER_KICK 투표 생성]
    J --> K[팔로워 전원 알림]
    K --> L[투표 진행 - 72시간]
    
    L --> M{팔로워 70% 도달?}
    M -->|No| N[투표 부결]
    N --> O["리더 교체 투표가 부결되었습니다"]
    
    M -->|Yes| P[리더 탄핵 승인]
    P --> Q[새 리더 선출 화면]
    Q --> R[후보자 목록]
    R --> S[투표 또는 자동 선정]
    S --> T[새 리더 확정]
    T --> U[역할 변경 처리]
    U --> V[전체 알림]
    V --> W["OOO님이 새 리더가 되었습니다"]
```

**LEADER_KICK 투표 규칙:**
| 항목 | 값 |
|------|-----|
| 발의 가능자 | 팔로워만 |
| 투표 대상 | 팔로워만 (리더 제외) |
| 승인 조건 | 팔로워의 70% 이상 |
| 새 리더 선정 | 최다 득표 또는 자동 지정 |

### 2.2 리더 권한 위임 플로우

> **트리거:** 리더가 자발적으로 권한 이전
> **연관 API:** `POST /challenges/{id}/delegate`

```mermaid
flowchart TD
    A[설정 > 리더 권한 위임] --> B{요청자 역할?}
    B -->|팔로워| C["리더만 가능" 안내]
    
    B -->|리더| D[위임 대상 선택]
    D --> E[팔로워 목록]
    E --> F[대상 선택]
    F --> G["OOO님에게 리더 권한을 위임하시겠습니까?"]
    
    G --> H{확인?}
    H -->|No| I[취소]
    
    H -->|Yes| J[권한 위임 API]
    J --> K{API 성공?}
    K -->|No| L[에러 Toast]
    
    K -->|Yes| M[역할 변경 처리]
    M --> N[기존 리더 → 팔로워]
    N --> O[새 리더 → 리더]
    O --> P[전체 알림]
    P --> Q["OOO님이 새 리더가 되었습니다"]
    Q --> R[설정 UI 갱신]
```

### 2.3 공지사항 등록 플로우 (리더 전용)

> **트리거:** 리더가 피드에 공지 등록
> **연관 API:** `POST /challenges/{id}/posts` (isPinned: true)

```mermaid
flowchart TD
    A[피드 탭] --> B{사용자 역할?}
    B -->|팔로워| C[일반 글쓰기만 표시]
    
    B -->|리더| D[글쓰기 모달]
    D --> E["📌 공지로 등록" 토글]
    E --> F{공지 설정?}
    
    F -->|No| G[일반 게시글 플로우]
    
    F -->|Yes| H[공지 내용 작성]
    H --> I{기존 공지 있음?}
    I -->|Yes| J["기존 공지가 내려갑니다" 안내]
    I -->|No| K[계속]
    J --> K
    
    K --> L[게시 버튼]
    L --> M[isPinned: true 설정]
    M --> N[게시글 API 호출]
    N --> O[성공 Toast]
    O --> P[피드 최상단 고정]
    P --> Q[📌 아이콘 표시]
```

---

## 3. 알림 도메인 (Notification)

### 3.1 푸시 알림 딥링크 플로우

> **트리거:** 푸시 알림 탭
> **연관 API:** `GET /notifications`

```mermaid
flowchart TD
    A[푸시 알림 수신] --> B[알림 탭]
    B --> C[알림 타입 파싱]
    
    C --> D{알림 타입?}
    
    D -->|VOTE| E[투표 상세 화면]
    E --> F["/challenges/ID/votes/VOTE_ID"]
    
    D -->|COMMENT| G[게시글 상세]
    G --> H["/challenges/ID/posts/POST_ID"]
    H --> I[해당 댓글 하이라이트]
    
    D -->|SUPPORT| J[어카운트 화면]
    J --> K["/mypage/account"]
    
    D -->|MEETING| L[모임 상세]
    L --> M["/challenges/ID/meetings/MEETING_ID"]
    
    D -->|KICK| N[홈 화면]
    N --> O["챌린지에서 퇴장되었습니다" Toast]
    
    D -->|PERMISSION| P[충전 모달]
    P --> Q[권한 박탈 안내]
```

**알림 타입별 라우팅:**
| 알림 타입 | 대상 화면 | 추가 액션 |
|----------|----------|----------|
| `VOTE_CREATED` | 투표 상세 | - |
| `VOTE_RESULT` | 투표 상세 | 결과 표시 |
| `COMMENT_NEW` | 게시글 상세 | 댓글 하이라이트 |
| `SUPPORT_PAID` | 어카운트 | 잔액 갱신 |
| `MEETING_CONFIRMED` | 모임 상세 | 참석 확인 |
| `KICKED` | 홈 | Toast 표시 |
| `PERMISSION_REVOKED` | 충전 모달 | 복구 유도 |

---

## 4. 금융 도메인 (Finance)

### 4.1 출금 플로우

> **트리거:** 마이페이지에서 출금 버튼 클릭
> **연관 API:** `POST /accounts/withdraw`

```mermaid
flowchart TD
    A[마이페이지] --> B[출금하기 버튼]
    B --> C[출금 모달]
    
    C --> D[가용 잔액 표시]
    D --> E["보증금 락: OOO원은 출금 불가"]
    E --> F[출금 금액 입력]
    
    F --> G{금액 유효?}
    G -->|가용 초과| H["가용 잔액을 초과했습니다"]
    G -->|최소 미만| I["최소 출금: 10,000원"]
    
    G -->|유효| J[출금 계좌 선택]
    J --> K{계좌 등록됨?}
    K -->|No| L[계좌 등록 화면]
    L --> M[은행 선택]
    M --> N[계좌번호 입력]
    N --> O[1원 인증]
    O --> P[인증 완료]
    P --> K
    
    K -->|Yes| Q[계좌 선택]
    Q --> R[출금 확인]
    R --> S["출금 수수료: 0원"]
    S --> T{최종 확인?}
    T -->|No| U[취소]
    
    T -->|Yes| V[생체 인증]
    V --> W{인증 성공?}
    W -->|No| X[인증 재시도]
    X --> V
    
    W -->|Yes| Y[출금 API 호출]
    Y --> Z["출금 신청 완료" Toast]
    Z --> AA["1-3 영업일 내 입금 예정"]
    AA --> AB[잔액 갱신]
```

**출금 규칙:**
| 항목 | 값 |
|------|-----|
| 최소 출금 | 10,000원 |
| 최대 출금 | 가용 잔액 전체 |
| 수수료 | 0원 |
| 소요 시간 | 1-3 영업일 |

---

## 5. 시스템 도메인 (System)

### 5.1 콘텐츠 신고 플로우

> **트리거:** 게시글/댓글에서 신고 버튼 클릭
> **연관 API:** `POST /reports`

```mermaid
flowchart TD
    A[게시글/댓글] --> B[더보기 메뉴]
    B --> C[신고하기]
    
    C --> D[신고 사유 선택]
    D --> E{사유 선택}
    
    E --> F[욕설/비방]
    E --> G[스팸/광고]
    E --> H[개인정보 노출]
    E --> I[불법 콘텐츠]
    E --> J[기타]
    
    F --> K[추가 설명 입력]
    G --> K
    H --> K
    I --> K
    J --> K
    
    K --> L["(선택) 상세 내용"]
    L --> M[신고 접수]
    
    M --> N[신고 API 호출]
    N --> O{성공?}
    O -->|No| P[에러 Toast]
    
    O -->|Yes| Q["신고가 접수되었습니다" Toast]
    Q --> R["검토 후 조치 예정"]
    R --> S[해당 콘텐츠 블러 처리]
```

**신고 사유 코드:**
| 코드 | 사유 | 자동 처리 |
|------|------|----------|
| `ABUSE` | 욕설/비방 | AI 필터링 |
| `SPAM` | 스팸/광고 | 즉시 숨김 |
| `PRIVACY` | 개인정보 노출 | 긴급 검토 |
| `ILLEGAL` | 불법 콘텐츠 | 긴급 검토 |
| `OTHER` | 기타 | 일반 검토 |

---

## 관련 문서

- [UX_FLOW.md](./UX_FLOW.md) - 핵심 플로우 요약
- [UX_FLOW_P0.md](./UX_FLOW_P0.md) - P0 Core 플로우
- [UX_SCENARIOS.md](../Strategy/UX_SCENARIOS.md) - 시나리오 상세
- [P1_Essential_APIs.md](../../../03_DEVOPS/P1_Essential_APIs.md) - P1 API 목록
