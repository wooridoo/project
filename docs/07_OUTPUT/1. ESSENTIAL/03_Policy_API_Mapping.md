# WOORIDO 정책-API 매핑표

## 문서 정보

| 항목       | 내용                                                          |
|------------|---------------------------------------------------------------|
| 작성일     | 2026-01-16                                                    |
| 버전       | 1.0.0                                                         |
| 기준 문서  | POLICY_DEFINITION.md, API_SCHEMA_1.0.0.md, 1-1_API_ENDPOINT.md |
| 운영 정책  | P-001 ~ P-061                                                 |
| 권한 정책  | PM-001 ~ PM-021                                               |

---

## 1. 운영 정책-API 매핑

### 1.1 회원가입 정책 (P-001 ~ P-005)

| 정책 코드 | 정책명              | 관련 API                                | API 번호  | 비고                              |
|-----------|---------------------|-----------------------------------------|-----------|-----------------------------------|
| P-001     | 약관 동의 (필수)    | POST /auth/signup                       | 001       | Request: agreements.privacy 필수  |
| P-002     | 약관 동의 (선택)    | POST /auth/signup                       | 001       | Request: agreements.marketing     |
| P-003     | 이름 작성 정책      | POST /auth/signup                       | 001       | Validation: 한글 2~10자           |
| P-004     | 이메일 규칙         | POST /auth/signup, GET /auth/check-email | 001, 005  | 중복 확인 API 별도                |
| P-005     | 비밀번호 정책       | POST /auth/signup                       | 001       | 8자 이상, 영문+숫자 필수          |

### 1.2 크레딧 정책 (P-006 ~ P-012, P-060)

| 정책 코드 | 정책명              | 관련 API                              | API 번호  | 비고                       |
|-----------|---------------------|---------------------------------------|-----------|----------------------------|
| P-006     | 최소 충전 금액      | POST /accounts/{accountId}/deposit    | 015       | Validation: min 10,000     |
| P-007     | 최대 충전 금액      | POST /accounts/{accountId}/deposit    | 015       | Validation: max 1,000,000  |
| P-008     | 출금 가능 금액      | POST /accounts/{accountId}/withdraw   | 016       | 가용 크레딧 한도 내        |
| P-009     | 출금 처리 시간      | POST /accounts/{accountId}/withdraw   | 016       | 영업일 1~3일               |
| P-010     | 소액 충전 수수료    | POST /accounts/{accountId}/deposit    | 015       | 10,000원 미만: 1%          |
| P-011     | 일반 충전 수수료    | POST /accounts/{accountId}/deposit    | 015       | 10,000~200,000원: 3%       |
| P-012     | 고액 충전 수수료    | POST /accounts/{accountId}/deposit    | 015       | 200,000원 초과: 1.5%       |
| P-060     | 알림 설정 정책      | GET/PUT /users/{userId}/notification-settings | 074, 075 | 채널: Push, Email     |

### 1.3 챌린지 가입 정책 (P-013 ~ P-015)

| 정책 코드 | 정책명              | 관련 API                              | API 번호  | 비고                       |
|-----------|---------------------|---------------------------------------|-----------|----------------------------|
| P-013     | 첫 가입 결제 구성   | POST /challenges/{challengeId}/join   | 032       | 서포트 + 보증금 + 입회비   |
| P-014     | 크레딧 잔액 조건    | POST /challenges/{challengeId}/join   | 032       | 사전 잔액 검증             |
| P-015     | 입회비 산정 및 귀속 | POST /challenges/{challengeId}/join   | 032       | 챌린지 어카운트 자동 합산  |

### 1.4 서포트 정책 (P-016 ~ P-017)

| 정책 코드 | 정책명              | 관련 API | API 번호 | 비고                          |
|-----------|---------------------|----------|----------|-------------------------------|
| P-016     | 자동 납입 시점      | -        | -        | 배치 처리 (매월 1일 00:00)    |
| P-017     | 크레딧 부족 시 충당 | -        | -        | 배치 처리 (안심결제)          |

### 1.5 보증금 정책 (P-018 ~ P-022, P-052, P-056)

| 정책 코드 | 정책명              | 관련 API                            | API 번호 | 비고                          |
|-----------|---------------------|-------------------------------------|----------|-------------------------------|
| P-018     | 권한 박탈           | -                                   | -        | 배치 처리 (privilege_status)  |
| P-019     | 복구 우선순위       | POST /accounts/{accountId}/deposit  | 015      | 보증금 락 1순위 복구          |
| P-020     | 권한 복구           | POST /accounts/{accountId}/deposit  | 015      | 보증금 충족 시 자동 복구      |
| P-021     | 권한 박탈 및 유예   | -                                   | -        | TODO: API 추가 필요           |
| P-052     | 보증금 몰수 정책    | -                                   | -        | 배치 처리 (60일 자동 탈퇴 시) |
| P-056     | 권한 복구 정책      | POST /accounts/{accountId}/deposit  | 015      | 충전 시 자동 복구             |

### 1.6 탈퇴 정책 (P-022 ~ P-025)

| 정책 코드 | 정책명              | 관련 API                            | API 번호 | 비고                     |
|-----------|---------------------|-------------------------------------|----------|--------------------------|
| P-022     | 자동 탈퇴 시점      | -                                   | -        | 배치 처리 (60일 미충전)  |
| P-023     | 자동 탈퇴 알림      | POST /notifications                 | 076      | 리더에게만 알림          |
| P-024     | 정상 탈퇴 조건      | DELETE /challenges/{challengeId}/leave | 034   | 보증금 충족 상태 검증    |
| P-025     | 정상 탈퇴 시 보증금 | DELETE /challenges/{challengeId}/leave | 034   | 보증금 락 해제 처리      |

### 1.7 완주 정책 (P-026 ~ P-028)

| 정책 코드 | 정책명              | 관련 API                    | API 번호 | 비고                     |
|-----------|---------------------|-----------------------------|----------|--------------------------|
| P-026     | 완주 인증 조건      | -                           | -        | 배치 처리 (365일 연속)   |
| P-027     | 인증 뱃지 부여      | GET /challenges/{challengeId} | 023    | Response: badges 필드    |
| P-028     | 보증금 관계         | -                           | -        | 완주와 보증금 무관       |

### 1.8 장부 정책 (P-029)

| 정책 코드 | 정책명              | 관련 API                          | API 번호 | 비고           |
|-----------|---------------------|-----------------------------------|----------|----------------|
| P-029     | 사용처 기록         | GET /challenges/{challengeId}/ledger | 052   | PG 자동 기록   |

### 1.9 바코드 정책 (P-053)

| 정책 코드 | 정책명              | 관련 API                       | API 번호 | 비고              |
|-----------|---------------------|--------------------------------|----------|-------------------|
| P-053     | 바코드 유효 기간    | POST /expenses/{expenseId}/barcode | 050  | 유효 기간: 10분   |

### 1.10 신고 정책 (P-030 ~ P-031, P-055)

| 정책 코드 | 정책명              | 관련 API              | API 번호 | 비고                       |
|-----------|---------------------|-----------------------|----------|----------------------------|
| P-030     | 신고 누적 방식      | POST /reports         | 072      | 1계정 1회, 20회 시 정지    |
| P-031     | 허위 신고 처리      | GET /reports/{reportId} | 073    | CS 검토 후 처리            |
| P-055     | 허위 신고 제재      | -                     | -        | CS 처리 (단계별 제재)      |

### 1.11 다중계정 정책 (P-032)

| 정책 코드 | 정책명              | 관련 API         | API 번호 | 비고                   |
|-----------|---------------------|------------------|----------|------------------------|
| P-032     | 동일인 중복 가입    | POST /auth/signup | 001     | 기기 ID + IP 기반 검증 |

### 1.12 리더 정책 (P-033 ~ P-035, P-058)

| 정책 코드 | 정책명              | 관련 API                              | API 번호           | 비고                  |
|-----------|---------------------|---------------------------------------|--------------------|-----------------------|
| P-033     | 리더 미활동 처리    | POST /votes                           | 040                | LEADER_KICK 투표 생성 |
| P-034     | 리더 승계 순서      | -                                     | -                  | 투표 승인 시 자동 처리 |
| P-035     | 점수 기반 승계      | GET /challenges/{challengeId}/members | 031                | total_score 기준      |
| P-058     | 리더 활동 갱신      | POST /posts, /votes, /comments, /meetings | 057, 040, 066, 035 | 활동 시 자동 갱신 |

### 1.13 휴면 챌린지 정책 (P-036)

| 정책 코드 | 정책명              | 관련 API | API 번호 | 비고                       |
|-----------|---------------------|----------|----------|----------------------------|
| P-036     | 잔액 귀속           | -        | -        | 배치 처리 (전원 탈퇴 시)   |

### 1.14 투표 시스템 정책 (P-037 ~ P-042)

| 정책 코드 | 정책명              | 관련 API                              | API 번호  | 비고                        |
|-----------|---------------------|---------------------------------------|-----------|-----------------------------|
| P-037     | 지출 투표           | POST /expenses/{expenseId}/vote       | 048       | 과반수 승인                 |
| P-038     | 멤버 퇴출 투표      | POST /votes, POST /votes/{voteId}/cast | 040, 041 | type: KICK, 70% 승인        |
| P-039     | 정기 모임 참석 투표 | POST /meetings/{meetingId}/vote       | 038       | type: MEETING_ATTENDANCE    |
| P-040     | 리더 강퇴 투표      | POST /votes, POST /votes/{voteId}/cast | 040, 041 | type: LEADER_KICK, 70% 승인 |
| P-041     | 챌린지 종료 투표    | POST /votes, POST /votes/{voteId}/cast | 040, 041 | type: DISSOLVE, 100% 승인   |
| P-042     | 모임 관련 지출 투표 | POST /expenses/{expenseId}/vote       | 048       | meeting_id 포함, 참석자 과반수 |

### 1.15 정기 모임 정책 (P-043 ~ P-045)

| 정책 코드 | 정책명              | 관련 API                        | API 번호 | 비고                    |
|-----------|---------------------|---------------------------------|----------|-------------------------|
| P-043     | 개최 조건           | POST /meetings/{meetingId}/vote | 038      | 과반수 참석 필수        |
| P-044     | 지출 투표 규칙      | POST /expenses/{expenseId}/vote | 048      | 참석자만 투표 가능      |
| P-045     | 권한 박탈 시 제한   | POST /meetings/{meetingId}/vote | 038      | privilege_status 검증   |

### 1.16 챌린지 상태 정책 (P-046 ~ P-050, P-057)

| 정책 코드 | 정책명              | 관련 API                          | API 번호 | 비고                      |
|-----------|---------------------|-----------------------------------|----------|---------------------------|
| P-046     | RECRUITING 상태     | POST /challenges                  | 022      | 초기 상태                 |
| P-047     | ACTIVE 전환         | POST /challenges/{challengeId}/join | 032    | 3명 충족 시 자동 전환     |
| P-048     | ACTIVE 상태         | GET /challenges/{challengeId}     | 023      | 서포트 납입 시작          |
| P-049     | CLOSED 전환         | POST /votes/{voteId}/cast         | 041      | DISSOLVE 전원 동의        |
| P-050     | CLOSED 상태         | GET /challenges/{challengeId}     | 023      | 읽기 전용                 |
| P-057     | PAUSED 상태         | PUT /challenges/{challengeId}     | 024      | 리더 요청 또는 시스템 정지 |

### 1.17 점수 정책 (P-051, P-054, P-059, P-061)

| 정책 코드 | 정책명              | 관련 API                          | API 번호 | 비고                       |
|-----------|---------------------|-----------------------------------|----------|----------------------------|
| P-051     | 모임 참석 점수      | PUT /meetings/{meetingId}/attendance | 039   | +0.09점                    |
| P-054     | NO_SHOW 패널티      | PUT /meetings/{meetingId}/attendance | 039   | -0.09점                    |
| P-059     | Webhook 실패 정책   | -                                 | -        | 시스템 처리 (3회 재시도)   |
| P-061     | 점수 산정 배치      | GET /analytics/user-scores        | 087      | Django 배치 (매월 1일)     |

---

## 2. 권한 정책-API 매핑

### 2.1 챌린지 권한 (PM-001 ~ PM-003)

| 정책 코드 | 정책명       | 사용자   | 관련 API                                | API 번호       | 권한       |
|-----------|--------------|----------|-----------------------------------------|----------------|------------|
| PM-001    | 챌린지 정보  | 리더     | GET/PUT/DELETE /challenges/{challengeId} | 023, 024, 025 | CRUD 전체  |
| PM-002    | 챌린지 정보  | 팔로워   | GET /challenges/{challengeId}           | 023            | 읽기만     |
| PM-003    | 챌린지 정보  | 비회원   | GET /challenges/{challengeId}           | 023            | 공개 정보만 |

### 2.2 피드 권한 (PM-004 ~ PM-006)

| 정책 코드 | 정책명   | 사용자   | 관련 API                  | API 번호       | 권한              |
|-----------|----------|----------|---------------------------|----------------|-------------------|
| PM-004    | 게시글   | 리더     | POST/PUT/DELETE /posts    | 057, 059, 060  | CRUD + 공지 핀    |
| PM-005    | 게시글   | 팔로워   | POST/PUT/DELETE /posts    | 057, 059, 060  | 본인 글만 수정/삭제 |
| PM-006    | 게시글   | 비회원   | -                         | -              | 권한 없음         |

### 2.3 투표 권한 (PM-007 ~ PM-011)

| 정책 코드 | 정책명         | 사용자   | 관련 API                        | API 번호 | 권한       |
|-----------|----------------|----------|---------------------------------|----------|------------|
| PM-007    | 오픈 투표      | 리더     | POST /votes                     | 040      | 생성/관리  |
| PM-008    | 오픈 투표      | 팔로워   | POST /votes/{voteId}/cast       | 041      | 참여만     |
| PM-009    | 정기 모임 투표 | 리더     | POST /meetings                  | 035      | 생성       |
| PM-010    | 정기 모임 투표 | 팔로워   | POST /meetings/{meetingId}/vote | 038      | 참석/불참  |
| PM-011    | 정기 모임 투표 | 권한박탈 | GET /meetings/{meetingId}       | 036      | 보기만     |

### 2.4 장부 권한 (PM-012 ~ PM-013)

| 정책 코드 | 정책명     | 사용자   | 관련 API                              | API 번호  | 권한          |
|-----------|------------|----------|---------------------------------------|-----------|---------------|
| PM-012    | 거래 내역  | 리더     | GET/PUT /challenges/{challengeId}/ledger | 052, 053 | 메모 수정 가능 |
| PM-013    | 거래 내역  | 팔로워   | GET /challenges/{challengeId}/ledger  | 052       | 읽기만        |

### 2.5 멤버 권한 (PM-014 ~ PM-015)

| 정책 코드 | 정책명     | 사용자   | 관련 API                                    | API 번호  | 권한            |
|-----------|------------|----------|---------------------------------------------|-----------|-----------------|
| PM-014    | 멤버 관리  | 리더     | GET /challenges/{challengeId}/members, POST /votes | 031, 040 | 강퇴 투표 생성 |
| PM-015    | 멤버 관리  | 팔로워   | GET /challenges/{challengeId}/members       | 031       | 목록 보기만     |

### 2.6 정기 모임 권한 (PM-016 ~ PM-019)

| 정책 코드 | 정책명     | 사용자   | 관련 API                          | API 번호 | 권한       |
|-----------|------------|----------|-----------------------------------|----------|------------|
| PM-016    | 모임 참석  | 팔로워   | POST /meetings/{meetingId}/vote   | 038      | 참석 등록  |
| PM-017    | 모임 참석  | 권한박탈 | GET /meetings/{meetingId}         | 036      | 참석 불가  |
| PM-018    | 모임 지출  | 참석자   | POST /expenses/{expenseId}/vote   | 048      | 투표 가능  |
| PM-019    | 모임 지출  | 미참석자 | GET /expenses/{expenseId}         | 047      | 보기만     |

### 2.7 리더 강퇴/유예 권한 (PM-020 ~ PM-021)

| 정책 코드 | 정책명     | 사용자   | 관련 API                        | API 번호 | 권한              |
|-----------|------------|----------|---------------------------------|----------|-------------------|
| PM-020    | 강퇴 요청  | 팔로워   | POST /votes                     | 040      | 30일 미활동 시에만 |
| PM-021    | 모임 참여  | 유예상태 | POST /meetings/{meetingId}/vote | 038      | 7일 내 참여 가능  |

---

## 3. 정책 커버리지 요약

### 3.1 운영 정책 통계

| 구분                         | 정책 수 | API 연결 | 배치 처리 | 미정의 |
|------------------------------|---------|----------|-----------|--------|
| 회원가입 (P-001~005)         | 5       | 5        | 0         | 0      |
| 크레딧 (P-006~012, 060)      | 8       | 7        | 1         | 0      |
| 챌린지 가입 (P-013~015)      | 3       | 3        | 0         | 0      |
| 서포트 (P-016~017)           | 2       | 0        | 2         | 0      |
| 보증금 (P-018~022, 052, 056) | 7       | 3        | 4         | 0      |
| 탈퇴 (P-022~025)             | 4       | 2        | 2         | 0      |
| 완주 (P-026~028)             | 3       | 1        | 2         | 0      |
| 장부 (P-029)                 | 1       | 1        | 0         | 0      |
| 바코드 (P-053)               | 1       | 1        | 0         | 0      |
| 신고 (P-030~031, 055)        | 3       | 2        | 1         | 0      |
| 다중계정 (P-032)             | 1       | 1        | 0         | 0      |
| 리더 (P-033~035, 058)        | 4       | 3        | 1         | 0      |
| 휴면 챌린지 (P-036)          | 1       | 0        | 1         | 0      |
| 투표 시스템 (P-037~042)      | 6       | 6        | 0         | 0      |
| 정기 모임 (P-043~045)        | 3       | 3        | 0         | 0      |
| 챌린지 상태 (P-046~050, 057) | 6       | 6        | 0         | 0      |
| 점수 (P-051, 054, 059, 061)  | 4       | 2        | 2         | 0      |
| **합계**                     | **62**  | **46**   | **16**    | **0**  |

### 3.2 권한 정책 통계

| 구분                         | 정책 수 | API 연결 |
|------------------------------|---------|----------|
| 챌린지 권한 (PM-001~003)     | 3       | 3        |
| 피드 권한 (PM-004~006)       | 3       | 2        |
| 투표 권한 (PM-007~011)       | 5       | 5        |
| 장부 권한 (PM-012~013)       | 2       | 2        |
| 멤버 권한 (PM-014~015)       | 2       | 2        |
| 정기 모임 권한 (PM-016~019)  | 4       | 4        |
| 리더/유예 권한 (PM-020~021)  | 2       | 2        |
| **합계**                     | **21**  | **20**   |

---

## 4. 배치 처리 정책 목록

| 정책 코드 | 정책명                 | 실행 주기          | 담당         |
|-----------|------------------------|--------------------|--------------|
| P-016     | 서포트 자동 납입       | 매월 1일 00:00     | Spring Batch |
| P-017     | 안심결제 (보증금 충당) | 매월 1일 00:00     | Spring Batch |
| P-018     | 권한 박탈 처리         | 실시간 (충당 시)   | Spring       |
| P-022     | 자동 탈퇴 처리         | 매일 00:00         | Spring Batch |
| P-026     | 완주 인증 처리         | 매일 00:00         | Spring Batch |
| P-036     | 휴면 챌린지 잔액 귀속  | 이벤트 기반        | Spring       |
| P-052     | 보증금 몰수 처리       | 자동 탈퇴 시       | Spring Batch |
| P-055     | 허위 신고 제재         | CS 처리            | Admin        |
| P-059     | Webhook 재시도         | 실시간 (1분/5분/30분) | Spring    |
| P-061     | 점수 산정 배치         | 매월 1일 00:00     | Django       |

---

## 5. TODO / 미비 사항

| 항목           | 설명                                         | 우선순위 |
|----------------|----------------------------------------------|----------|
| P-021 API      | GET /users/{userId}/privilege-status API 추가 필요 | High |
| PM-006 API     | 비회원 게시글 접근 제한 로직 확인 필요       | Medium   |
| 05_API_EXPENSE | EXPENSE 도메인 상세 문서 작성 필요           | High     |

---

## 관련 문서

- [POLICY_DEFINITION.md](./POLICY_DEFINITION.md)
- [API_SCHEMA_1.0.0.md](./API_SCHEMA_1.0.0.md)
- [1-1_API_ENDPOINT.md](./1-1_API_ENDPOINT.md)
- [DB_Schema_1.0.0.md](./DB_Schema_1.0.0.md)