WOORIDO 아키텍처 다이어그램
버전: 1.0.0 작성일: 2026-01-16 기준 문서: SYSTEM_ARCHITECTURE.md v3.0, PRODUCT_AGENDA.md v4.2, BACKLOG.md SSOT 원칙: DB Schema > Policy > API Schema > 개별 도메인 문서

1. 문서 개요
1.1 목적
본 문서는 WOORIDO 시스템의 전체 아키텍처를 시각적 다이어그램과 함께 정의합니다. 3-Tier 아키텍처, 데이터 흐름, 배포 구조, 보안 계층을 포함합니다.

1.2 아키텍처 핵심 원칙
WOORIDO는 다음 핵심 원칙을 따릅니다.

첫째, Spring Boot가 메인 백엔드로서 모든 비즈니스 로직과 Oracle DB Write/Read를 담당합니다. 둘째, Django는 서브 백엔드로서 알고리즘, 연산, 검색만 담당하며 Oracle에 직접 접근하지 않습니다. 셋째, 데이터 동기화는 Spring Boot에서 Django로 REST API/Webhook을 통해 이루어집니다. 넷째, Elasticsearch는 Django만 접근하며 검색/추천 엔진으로 활용됩니다.

> [!IMPORTANT]
> **[PostDemo 기능]** 본 문서의 Django 로컬 DB (PostgreSQL 15), sync_* 테이블, django-db 컨테이너 관련 내용은 MVP/DemoDay 이후에 적용됩니다. MVP 시점에는 Django가 DB 연결 없이 Spring Boot API를 통해 실시간 데이터를 받아 처리합니다.

2. 전체 시스템 아키텍처
2.1 시스템 구조도 (Mermaid)
graph TB
    subgraph "Client Layer"
        Web[React Web App<br/>Vite 5.4.x]
    end

    subgraph "API Gateway"
        Nginx[Nginx 1.25.3<br/>Reverse Proxy]
    end

    subgraph "Application Layer"
        subgraph "Main Backend"
            Spring[Spring Boot 3.2.3<br/>Java 21 LTS<br/>Virtual Threads]
        end
        subgraph "Sub Backend"
            Django[Django 5.0.1<br/>Python 3.11<br/>알고리즘/검색]
        end
    end

    subgraph "Data Layer"
        Oracle[(Oracle 21c XE<br/>메인 데이터베이스)]
        ES[(Elasticsearch 8.11.3<br/>검색/추천 엔진)]
        DjangoDB[(PostgreSQL 15<br/>Django 로컬 DB)]
    end

    Web -->|HTTPS| Nginx
    Nginx -->|/api/*| Spring
    Nginx -->|/analytics/*<br/>/search/*| Django
    Spring -->|JDBC/MyBatis<br/>Write & Read| Oracle
    Spring -->|REST API/Webhook<br/>데이터 동기화| Django
    Django -->|ORM| DjangoDB
    Django -->|Python Client<br/>Index & Search| ES

2.2 시스템 구조도 (ASCII)
┌─────────────────────────────────────────────────────────────────────────────┐
│                              CLIENT LAYER                                    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                     React Web App (Vite 5.4.x)                       │    │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐        │    │
│  │  │  Pages  │ │Components│ │Services │ │  Store  │ │  Hooks  │        │    │
│  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘        │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      │ HTTPS
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              API GATEWAY                                     │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                      Nginx 1.25.3 (Reverse Proxy)                    │    │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐            │    │
│  │  │   /api/*      │  │ /analytics/*  │  │  /search/*    │            │    │
│  │  │   → :8000     │  │   → :8001     │  │   → :8001     │            │    │
│  │  └───────────────┘  └───────────────┘  └───────────────┘            │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
                    │                              │
                    │ /api/*                       │ /analytics/*, /search/*
                    ▼                              ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           APPLICATION LAYER                                  │
│  ┌────────────────────────────┐    ┌────────────────────────────┐          │
│  │   MAIN BACKEND (Spring)    │    │   SUB BACKEND (Django)     │          │
│  │  ┌──────────────────────┐  │    │  ┌──────────────────────┐  │          │
│  │  │ Spring Boot 3.2.3    │  │    │  │ Django 5.0.1         │  │          │
│  │  │ Java 21 (LTS)        │  │    │  │ Python 3.11          │  │          │
│  │  │ Virtual Threads      │  │    │  │ DRF 3.14.0           │  │          │
│  │  │ MyBatis 3.0.3        │  │    │  │ Pandas 2.1.4         │  │          │
│  │  │ Spring Security 6.x  │  │    │  │ ES-py 8.11.1         │  │          │
│  │  │ Spring Retry 2.0.5   │  │    │  │                      │  │          │
│  │  └──────────────────────┘  │    │  └──────────────────────┘  │          │
│  │                            │    │                            │          │
│  │  역할:                     │    │  역할:                     │          │
│  │  • 비즈니스 로직 (CRUD)    │───▶│  • 알고리즘/연산           │          │
│  │  • 트랜잭션 관리           │REST│  • 통계 분석 (Pandas)      │          │
│  │  • 인증/인가 (JWT)        │API │  • 검색 쿼리 (ES)          │          │
│  │  • Django 데이터 전달     │    │  • 추천 알고리즘           │          │
│  └────────────────────────────┘    └────────────────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────┘
           │                              │                    │
           │ JDBC/MyBatis                 │ ORM                │ ES Client
           ▼                              ▼                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              DATA LAYER                                      │
│  ┌────────────────────┐  ┌────────────────────┐  ┌────────────────────┐    │
│  │    Oracle 21c XE   │  │  PostgreSQL 15     │  │ Elasticsearch 8.11 │    │
│  │   (메인 데이터베이스)  │  │ (Django 로컬 DB)   │  │  (검색/추천 엔진)   │    │
│  │                    │  │                    │  │                    │    │
│  │  • 32개 테이블     │  │  • 동기화 데이터   │  │  • challenges 인덱스│    │
│  │  • Spring만 접근   │  │  • Django만 접근   │  │  • feed_posts 인덱스│    │
│  │  • Write/Read     │  │  • Read 중심       │  │  • Django만 접근    │    │
│  └────────────────────┘  └────────────────────┘  └────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
3. 계층별 상세 아키텍처
3.1 Presentation Tier (Frontend)
┌─────────────────────────────────────────────────────────────────────────────┐
│                         REACT APPLICATION                                    │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                              PAGES                                   │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐  │    │
│  │  │ChallengeList │ │ChallengeDetail│ │   FeedPage   │ │ LedgerPage │  │    │
│  │  │    Page      │ │    Page      │ │              │ │            │  │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘  │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐  │    │
│  │  │  SearchPage  │ │   VotePage   │ │  MeetingPage │ │AccountPage │  │    │
│  │  │   (신규)     │ │              │ │              │ │            │  │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘  │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                           COMPONENTS                                 │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐  │    │
│  │  │ChallengeCard │ │  VotePanel   │ │ CommentList  │ │ SearchBar  │  │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘  │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐  │    │
│  │  │Recommendation│ │  LedgerChart │ │ MemberList   │ │ BrixBadge  │  │    │
│  │  │    Panel     │ │  (Recharts)  │ │              │ │            │  │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘  │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                           SERVICES                                   │    │
│  │  ┌──────────────────────────────────────────────────────────────┐   │    │
│  │  │                  API 호출 대상 분리                           │   │    │
│  │  │  ┌────────────────────────┐  ┌────────────────────────────┐  │   │    │
│  │  │  │    Spring Boot API     │  │       Django API           │  │   │    │
│  │  │  │  • challengeService    │  │  • ledgerAnalysisService   │  │   │    │
│  │  │  │  • voteService         │  │  • searchService           │  │   │    │
│  │  │  │  • authService         │  │  • recommendationService   │  │   │    │
│  │  │  │  • accountService      │  │                            │  │   │    │
│  │  │  │  • meetingService      │  │                            │  │   │    │
│  │  │  └────────────────────────┘  └────────────────────────────┘  │   │    │
│  │  └──────────────────────────────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                            STORE                                     │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐                 │    │
│  │  │  authStore   │ │challengeStore│ │  uiStore     │                 │    │
│  │  │  (Zustand)   │ │ (Zustand)    │ │  (Zustand)   │                 │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘                 │    │
│  │  ┌──────────────────────────────────────────────────────────────┐   │    │
│  │  │              React Query (서버 상태 관리)                     │   │    │
│  │  │  • useQuery (데이터 조회)                                    │   │    │
│  │  │  • useMutation (데이터 변경)                                 │   │    │
│  │  │  • 캐싱 및 자동 갱신                                         │   │    │
│  │  └──────────────────────────────────────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
3.2 Application Tier - Spring Boot (Main Backend)
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SPRING BOOT APPLICATION                              │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        CONTROLLER LAYER                              │    │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │    │
│  │  │    Auth     │ │  Challenge  │ │    Vote     │ │   Ledger    │   │    │
│  │  │ Controller  │ │ Controller  │ │ Controller  │ │ Controller  │   │    │
│  │  │ 001-008     │ │ 022-034     │ │ 041-045     │ │ 052-056     │   │    │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │    │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │    │
│  │  │    User     │ │   Meeting   │ │   Expense   │ │    Post     │   │    │
│  │  │ Controller  │ │ Controller  │ │ Controller  │ │ Controller  │   │    │
│  │  │ 009-014     │ │ 035-040     │ │ 046-051     │ │ 057-065     │   │    │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │    │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │    │
│  │  │   Account   │ │   Comment   │ │   Report    │ │Notification │   │    │
│  │  │ Controller  │ │ Controller  │ │ Controller  │ │ Controller  │   │    │
│  │  │ 015-021     │ │ 066-071     │ │ 072-073     │ │ 074-078     │   │    │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │    │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────────────┐   │    │
│  │  │   Refund    │ │ Settlement  │ │     Sync Controller         │   │    │
│  │  │ Controller  │ │ Controller  │ │   (Django 연동용, 신규)      │   │    │
│  │  │ 079-080     │ │ 081-082     │ │                             │   │    │
│  │  └─────────────┘ └─────────────┘ └─────────────────────────────┘   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                      │                                       │
│                                      ▼                                       │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         SERVICE LAYER                                │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                    비즈니스 로직 처리                         │    │    │
│  │  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐         │    │    │
│  │  │  │ChallengeService│ │  VoteService │ │TransactionService│      │    │    │
│  │  │  │• createChallenge│ │• createVote  │ │• processPayment │      │    │    │
│  │  │  │• joinChallenge │ │• castVote    │ │• refundDeposit  │      │    │    │
│  │  │  │• calcEntryFee  │ │• tallyVotes  │ │• syncToDjango   │      │    │    │
│  │  │  └──────────────┘ └──────────────┘ └──────────────┘         │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                  Django 동기화 서비스                        │    │    │
│  │  │  ┌──────────────────────────────────────────────────────┐   │    │    │
│  │  │  │              DjangoSyncService                       │   │    │    │
│  │  │  │  • sendChallengeData()  @Retryable(maxAttempts=3)   │   │    │    │
│  │  │  │  • sendTransactionData()                            │   │    │    │
│  │  │  │  • sendMemberData()                                 │   │    │    │
│  │  │  └──────────────────────────────────────────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                      │                                       │
│                                      ▼                                       │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        REPOSITORY LAYER                              │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                    MyBatis Mappers                          │    │    │
│  │  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐         │    │    │
│  │  │  │ChallengeMapper│ │  VoteMapper  │ │TransactionMapper│      │    │    │
│  │  │  │              │ │              │ │              │         │    │    │
│  │  │  └──────────────┘ └──────────────┘ └──────────────┘         │    │    │
│  │  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐         │    │    │
│  │  │  │ MeetingMapper │ │  PostMapper  │ │ CommentMapper │        │    │    │
│  │  │  │              │ │              │ │              │         │    │    │
│  │  │  └──────────────┘ └──────────────┘ └──────────────┘         │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                      │                                       │
│                                      ▼                                       │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         DOMAIN LAYER                                 │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐  │    │
│  │  │  Challenge   │ │    Vote      │ │ Transaction  │ │  Meeting   │  │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘  │    │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐  │    │
│  │  │    User      │ │    Post      │ │   Comment    │ │   Report   │  │    │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘  │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
3.3 Application Tier - Django (Sub Backend)
┌─────────────────────────────────────────────────────────────────────────────┐
│                          DJANGO APPLICATION                                  │
│                    (알고리즘/연산/검색 전담)                                   │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                           SYNC MODULE                                │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │              Spring Boot 데이터 수신 API                      │    │    │
│  │  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐   │    │    │
│  │  │  │ReceiveChallenge│ │ReceiveTransaction│ │ReceiveMember  │   │    │    │
│  │  │  │     View       │ │     View       │ │     View       │   │    │    │
│  │  │  │POST /sync/     │ │POST /sync/     │ │POST /sync/     │   │    │    │
│  │  │  │   challenge    │ │  transaction   │ │    member      │   │    │    │
│  │  │  └────────────────┘ └────────────────┘ └────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │              Django 로컬 DB 모델 (동기화 데이터 저장)         │    │    │
│  │  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐   │    │    │
│  │  │  │SyncChallenge   │ │SyncTransaction │ │  SyncMember    │   │    │    │
│  │  │  │    Model       │ │    Model       │ │    Model       │   │    │    │
│  │  │  └────────────────┘ └────────────────┘ └────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        ANALYTICS MODULE                              │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                       API (086-089)                          │    │    │
│  │  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐   │    │    │
│  │  │  │ UserActivity   │ │ChallengeAnalysis│ │   Dashboard    │   │    │    │
│  │  │  │     View       │ │     View       │ │     View       │   │    │    │
│  │  │  │ GET /analytics │ │ GET /analytics │ │ GET /analytics │   │    │    │
│  │  │  │ /user/activity │ │/challenge/{id} │ │  /dashboard    │   │    │    │
│  │  │  └────────────────┘ └────────────────┘ └────────────────┘   │    │    │
│  │  │  ┌────────────────┐                                         │    │    │
│  │  │  │  UserReport    │                                         │    │    │
│  │  │  │     View       │                                         │    │    │
│  │  │  │ GET /analytics │                                         │    │    │
│  │  │  │  /user/report  │                                         │    │    │
│  │  │  └────────────────┘                                         │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                     Processors (Pandas)                      │    │    │
│  │  │  • calculate_statistics()                                   │    │    │
│  │  │  • aggregate_transactions()                                 │    │    │
│  │  │  • compute_trends()                                         │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                         SEARCH MODULE                                │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                       API (083-085)                          │    │    │
│  │  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐   │    │    │
│  │  │  │ UnifiedSearch  │ │ChallengeSearch │ │  Autocomplete  │   │    │    │
│  │  │  │     View       │ │     View       │ │     View       │   │    │    │
│  │  │  │  GET /search   │ │ GET /search/   │ │ GET /search/   │   │    │    │
│  │  │  │               │ │  challenges    │ │  autocomplete  │   │    │    │
│  │  │  └────────────────┘ └────────────────┘ └────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                     Indexers (ES 인덱싱)                     │    │    │
│  │  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐   │    │    │
│  │  │  │ChallengeIndexer│ │  FeedIndexer   │ │  UserIndexer   │   │    │    │
│  │  │  │index_from_local│ │index_from_local│ │index_from_local│   │    │    │
│  │  │  └────────────────┘ └────────────────┘ └────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                     Query Builders                           │    │    │
│  │  │  • build_challenge_query() - Multi-match + Korean Analyzer  │    │    │
│  │  │  • build_autocomplete_query() - Prefix + Edge N-gram        │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                     RECOMMENDATIONS MODULE                           │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                       API (090-091)                          │    │    │
│  │  │  ┌─────────────────────────┐  ┌─────────────────────────┐   │    │    │
│  │  │  │ PersonalizedChallenge   │  │   SavingsPlan           │   │    │    │
│  │  │  │         View            │  │       View              │   │    │    │
│  │  │  │ GET /recommendations/   │  │ GET /recommendations/   │   │    │    │
│  │  │  │      challenges         │  │    savings-plan         │   │    │    │
│  │  │  └─────────────────────────┘  └─────────────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                      Algorithms                              │    │    │
│  │  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐   │    │    │
│  │  │  │ Collaborative  │ │ Content-Based  │ │    Hybrid      │   │    │    │
│  │  │  │  Filtering     │ │   Filtering    │ │  Recommender   │   │    │    │
│  │  │  │ (유사 사용자)   │ │ (유사 콘텐츠)   │ │ (0.5+0.3+0.2)  │   │    │    │
│  │  │  └────────────────┘ └────────────────┘ └────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        REPORTS MODULE                                │    │
│  │  ┌────────────────────────────────────────────────────────────┐     │    │
│  │  │ • generate_pdf_report()                                    │     │    │
│  │  │ • generate_csv_export()                                    │     │    │
│  │  │ • create_matplotlib_charts()                               │     │    │
│  │  └────────────────────────────────────────────────────────────┘     │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
4. 데이터 플로우 다이어그램
4.1 메인 데이터 흐름
┌─────────────────────────────────────────────────────────────────────────────┐
│                          DATA FLOW OVERVIEW                                  │
└─────────────────────────────────────────────────────────────────────────────┘

Flow 1: 비즈니스 로직 (CRUD)
┌────────┐    ┌───────────┐    ┌────────────┐    ┌────────────┐
│ React  │───▶│  Spring   │───▶│   Oracle   │───▶│  Response  │
│        │    │   Boot    │    │   (R/W)    │    │            │
└────────┘    └───────────┘    └────────────┘    └────────────┘

Flow 2: 데이터 동기화
┌───────────┐    ┌────────────┐    ┌────────────┐    ┌────────────┐
│  Spring   │───▶│   Django   │───▶│ PostgreSQL │───▶│    ES      │
│   Boot    │REST│   Sync     │ORM │  (Django)  │    │  Index     │
│  (Write)  │API │  Receiver  │    │            │    │            │
└───────────┘    └────────────┘    └────────────┘    └────────────┘

Flow 3: 검색/추천
┌────────┐    ┌───────────┐    ┌────────────┐    ┌────────────┐
│ React  │───▶│  Django   │───▶│Elasticsearch│───▶│  Response  │
│        │    │  Search   │    │  (Query)   │    │            │
└────────┘    └───────────┘    └────────────┘    └────────────┘

Flow 4: 분석
┌────────┐    ┌───────────┐    ┌────────────┐    ┌────────────┐
│ React  │───▶│  Django   │───▶│ PostgreSQL │───▶│  Pandas    │
│        │    │ Analytics │    │  (Django)  │    │ Processing │
└────────┘    └───────────┘    └────────────┘    └────────────┘
                                                       │
                                                       ▼
                                                 ┌────────────┐
                                                 │  Response  │
                                                 │  (Charts)  │
                                                 └────────────┘
4.2 챌린지 가입 플로우 (입회비 포함)
┌─────────────────────────────────────────────────────────────────────────────┐
│                    CHALLENGE JOIN FLOW (WITH ENTRY FEE)                      │
└─────────────────────────────────────────────────────────────────────────────┘

    User           React          Spring Boot         Oracle           Django
     │               │                 │                 │                │
     │ 가입 버튼 클릭  │                 │                 │                │
     │──────────────▶│                 │                 │                │
     │               │ POST /api/      │                 │                │
     │               │ challenges/{id}/│                 │                │
     │               │ join            │                 │                │
     │               │────────────────▶│                 │                │
     │               │                 │ SELECT balance, │                │
     │               │                 │ member_count    │                │
     │               │                 │────────────────▶│                │
     │               │                 │◀────────────────│                │
     │               │                 │ 3,000,000원,    │                │
     │               │                 │ 8명             │                │
     │               │                 │                 │                │
     │               │                 │ ┌─────────────────────────────┐  │
     │               │                 │ │ 입회비 계산:                 │  │
     │               │                 │ │ 3,000,000 / 8 = 375,000원   │  │
     │               │                 │ │ 총액: 100,000(보증금)       │  │
     │               │                 │ │       + 375,000 = 475,000원 │  │
     │               │                 │ └─────────────────────────────┘  │
     │               │                 │                 │                │
     │               │                 │ BEGIN TRANSACTION               │
     │               │                 │────────────────▶│                │
     │               │                 │ INSERT INTO     │                │
     │               │                 │ challenge_members               │
     │               │                 │────────────────▶│                │
     │               │                 │ INSERT INTO     │                │
     │               │                 │ transactions    │                │
     │               │                 │ (입회비)        │                │
     │               │                 │────────────────▶│                │
     │               │                 │ INSERT INTO     │                │
     │               │                 │ transactions    │                │
     │               │                 │ (보증금)        │                │
     │               │                 │────────────────▶│                │
     │               │                 │ UPDATE challenges               │
     │               │                 │ SET balance     │                │
     │               │                 │────────────────▶│                │
     │               │                 │ COMMIT          │                │
     │               │                 │────────────────▶│                │
     │               │                 │◀────────────────│                │
     │               │                 │ Success         │                │
     │               │                 │                 │                │
     │               │                 │ ════════════════════════════════│
     │               │                 │   데이터 동기화 (비동기)         │
     │               │                 │ ════════════════════════════════│
     │               │                 │                 │                │
     │               │                 │ POST /api/sync/member           │
     │               │                 │────────────────────────────────▶│
     │               │                 │                 │                │
     │               │                 │                 │   Django 로컬 │
     │               │                 │                 │   DB에 저장   │
     │               │                 │                 │                │
     │               │                 │◀────────────────────────────────│
     │               │                 │ 200 OK          │                │
     │               │                 │                 │                │
     │               │◀────────────────│                 │                │
     │               │ { memberId,     │                 │                │
     │               │   entryFee:     │                 │                │
     │               │   375000 }      │                 │                │
     │◀──────────────│                 │                 │                │
     │ 가입 완료      │                 │                 │                │
     │ (475,000원    │                 │                 │                │
     │  결제)        │                 │                 │                │
4.3 검색 플로우 (Django + Elasticsearch)
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SEARCH FLOW (DJANGO + ES)                            │
└─────────────────────────────────────────────────────────────────────────────┘

    User           React           Django          Elasticsearch
     │               │                │                  │
     │ "운동 챌린지"  │                │                  │
     │   검색        │                │                  │
     │──────────────▶│                │                  │
     │               │ GET /api/search│                  │
     │               │ /challenges    │                  │
     │               │ ?q=운동        │                  │
     │               │───────────────▶│                  │
     │               │                │                  │
     │               │                │ ┌──────────────────────────────┐
     │               │                │ │ Query 빌드:                  │
     │               │                │ │ {                            │
     │               │                │ │   "multi_match": {           │
     │               │                │ │     "query": "운동",         │
     │               │                │ │     "fields": ["title^3",    │
     │               │                │ │       "description^2",       │
     │               │                │ │       "tags"],               │
     │               │                │ │     "analyzer": "korean"     │
     │               │                │ │   }                          │
     │               │                │ │ }                            │
     │               │                │ └──────────────────────────────┘
     │               │                │                  │
     │               │                │ ES Search Query  │
     │               │                │─────────────────▶│
     │               │                │                  │
     │               │                │                  │ ┌──────────────┐
     │               │                │                  │ │ Nori 한글    │
     │               │                │                  │ │ 형태소 분석  │
     │               │                │                  │ │ "운동" →     │
     │               │                │                  │ │ [운동, 움직임]│
     │               │                │                  │ └──────────────┘
     │               │                │                  │
     │               │                │◀─────────────────│
     │               │                │ [매칭된 챌린지   │
     │               │                │  10건]          │
     │               │◀───────────────│                  │
     │               │ { results,     │                  │
     │               │   total: 10 }  │                  │
     │◀──────────────│                │                  │
     │ 검색 결과      │                │                  │
     │ 표시          │                │                  │
4.4 데이터 동기화 플로우 (Oracle → Spring → Django → ES)
┌─────────────────────────────────────────────────────────────────────────────┐
│                    DATA SYNCHRONIZATION FLOW                                 │
└─────────────────────────────────────────────────────────────────────────────┘

    Spring Boot        Oracle         Django         PostgreSQL    Elasticsearch
         │               │               │               │               │
         │               │               │               │               │
   ═══════════════════════════════════════════════════════════════════════════
   │                    방법 1: Webhook 기반 실시간 동기화                      │
   ═══════════════════════════════════════════════════════════════════════════
         │               │               │               │               │
         │ INSERT INTO   │               │               │               │
         │ challenges    │               │               │               │
         │──────────────▶│               │               │               │
         │◀──────────────│               │               │               │
         │ Success       │               │               │               │
         │               │               │               │               │
         │ POST /api/sync/challenge      │               │               │
         │ (Webhook)     │               │               │               │
         │──────────────────────────────▶│               │               │
         │               │               │               │               │
         │               │               │ INSERT INTO   │               │
         │               │               │ sync_challenges               │
         │               │               │──────────────▶│               │
         │               │               │◀──────────────│               │
         │               │               │               │               │
         │               │               │ ┌──────────────────────────┐  │
         │               │               │ │ popularity_score 계산    │  │
         │               │               │ │ (member_count * 10 +     │  │
         │               │               │ │  feed_count * 5)         │  │
         │               │               │ └──────────────────────────┘  │
         │               │               │               │               │
         │               │               │ Index Challenge Document      │
         │               │               │──────────────────────────────▶│
         │               │               │◀──────────────────────────────│
         │               │               │ Indexed        │               │
         │               │               │               │               │
         │◀──────────────────────────────│               │               │
         │ 200 OK        │               │               │               │
         │               │               │               │               │
   ═══════════════════════════════════════════════════════════════════════════
   │                    방법 2: 배치 동기화 (매일 03:00)                        │
   ═══════════════════════════════════════════════════════════════════════════
         │               │               │               │               │
         │               │               │ Celery Beat   │               │
         │               │               │ Trigger       │               │
         │               │               │               │               │
         │               │               │ SELECT * FROM │               │
         │               │               │ sync_challenges               │
         │               │               │──────────────▶│               │
         │               │               │◀──────────────│               │
         │               │               │ [100건]       │               │
         │               │               │               │               │
         │               │               │ ┌──────────────────────────┐  │
         │               │               │ │ Pandas로 popularity_score│  │
         │               │               │ │ 일괄 계산                │  │
         │               │               │ └──────────────────────────┘  │
         │               │               │               │               │
         │               │               │ Bulk Index (batch_size=100)   │
         │               │               │──────────────────────────────▶│
         │               │               │◀──────────────────────────────│
         │               │               │ Success        │               │
5. 배포 아키텍처
5.1 Docker Compose 구조 (Demo Day)
┌─────────────────────────────────────────────────────────────────────────────┐
│                      AWS EC2 Instance (t3.large)                             │
│                      CPU: 4 vCPU | RAM: 8GB | Disk: 50GB SSD                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                        Docker Compose                                │    │
│  │                                                                      │    │
│  │  ┌─────────────────────────────────────────────────────────────┐    │    │
│  │  │                     Nginx (Port 80)                          │    │    │
│  │  │  ┌──────────────────────────────────────────────────────┐   │    │    │
│  │  │  │ Reverse Proxy Rules:                                 │   │    │    │
│  │  │  │  • /api/*         → spring-boot:8000                 │   │    │    │
│  │  │  │  • /analytics/*   → django:8001                      │   │    │    │
│  │  │  │  • /search/*      → django:8001                      │   │    │    │
│  │  │  │  • /recommendations/* → django:8001                  │   │    │    │
│  │  │  │  • /*             → react-app:3000                   │   │    │    │
│  │  │  └──────────────────────────────────────────────────────┘   │    │    │
│  │  └─────────────────────────────────────────────────────────────┘    │    │
│  │                                │                                    │    │
│  │          ┌─────────────────────┼─────────────────────┐              │    │
│  │          │                     │                     │              │    │
│  │          ▼                     ▼                     ▼              │    │
│  │  ┌───────────────┐     ┌───────────────┐     ┌───────────────┐     │    │
│  │  │  react-app    │     │  spring-boot  │     │    django     │     │    │
│  │  │   :3000       │     │    :8000      │     │    :8001      │     │    │
│  │  │               │     │               │     │               │     │    │
│  │  │ React 18.2.0  │     │ Spring Boot   │     │ Django 5.0.1  │     │    │
│  │  │ Vite 5.4.x    │     │ 3.2.3         │     │ DRF 3.14.0    │     │    │
│  │  │               │     │ Java 21       │     │ Pandas 2.1.4  │     │    │
│  │  └───────────────┘     └───────────────┘     └───────────────┘     │    │
│  │                               │                     │              │    │
│  │                               │                     │              │    │
│  │  ┌────────────────────────────┼─────────────────────┼──────────┐   │    │
│  │  │                  DATA CONTAINERS                 │          │   │    │
│  │  │                            │                     │          │   │    │
│  │  │          ┌─────────────────┼─────────────────────┼────┐     │   │    │
│  │  │          │                 │                     │    │     │   │    │
│  │  │          ▼                 ▼                     ▼    │     │   │    │
│  │  │  ┌───────────────┐ ┌───────────────┐ ┌───────────────┐│     │   │    │
│  │  │  │  oracle-xe    │ │   django-db   │ │ elasticsearch ││     │   │    │
│  │  │  │   :1521       │ │    :5432      │ │    :9200      ││     │   │    │
│  │  │  │               │ │               │ │ (내부망 전용)  ││     │   │    │
│  │  │  │ Oracle 21c XE │ │ PostgreSQL 15 │ │ ES 8.11.3     ││     │   │    │
│  │  │  │               │ │               │ │ Nori Plugin   ││     │   │    │
│  │  │  └───────────────┘ └───────────────┘ └───────────────┘│     │   │    │
│  │  │                                                       │     │   │    │
│  │  └───────────────────────────────────────────────────────┘     │   │    │
│  │                                                                │   │    │
│  └────────────────────────────────────────────────────────────────┘   │    │
│                                                                       │    │
│  ┌────────────────────────────────────────────────────────────────┐   │    │
│  │                       VOLUME MOUNTS                             │   │    │
│  │  • /data/oracle     → Oracle DB 영구 저장                       │   │    │
│  │  • /data/postgres   → Django DB 영구 저장                       │   │    │
│  │  • /data/elasticsearch → ES 인덱스 저장                         │   │    │
│  │  • /logs            → 애플리케이션 로그                         │   │    │
│  └────────────────────────────────────────────────────────────────┘   │    │
│                                                                       │    │
└───────────────────────────────────────────────────────────────────────┘    │
5.2 네트워크 구조
┌─────────────────────────────────────────────────────────────────────────────┐
│                          NETWORK TOPOLOGY                                    │
└─────────────────────────────────────────────────────────────────────────────┘

                    ┌─────────────────────────────┐
                    │        INTERNET             │
                    │      (External)             │
                    └─────────────────────────────┘
                                 │
                                 │ Port 80/443
                                 ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              HOST                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                          Nginx                                       │    │
│  │                     (Public Gateway)                                 │    │
│  │                       0.0.0.0:80                                     │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                 │                                            │
│                                 │                                            │
│  ═══════════════════════════════════════════════════════════════════════    │
│                         DOCKER NETWORK: backend                              │
│  ═══════════════════════════════════════════════════════════════════════    │
│                                 │                                            │
│       ┌─────────────────────────┼─────────────────────────┐                 │
│       │                         │                         │                 │
│       ▼                         ▼                         ▼                 │
│  ┌─────────────┐         ┌─────────────┐         ┌─────────────┐           │
│  │ react-app   │         │spring-boot  │         │   django    │           │
│  │   :3000     │         │   :8000     │         │   :8001     │           │
│  │ (Internal)  │         │ (Internal)  │         │ (Internal)  │           │
│  └─────────────┘         └─────────────┘         └─────────────┘           │
│                                 │                    │    │                 │
│                                 │                    │    │                 │
│                                 │                    │    │                 │
│                                 ▼                    │    ▼                 │
│                          ┌─────────────┐            │ ┌─────────────┐      │
│                          │  oracle-xe  │            │ │ django-db   │      │
│                          │   :1521     │            │ │   :5432     │      │
│                          │ (Internal)  │            │ │ (Internal)  │      │
│                          └─────────────┘            │ └─────────────┘      │
│                                                     │                       │
│                                                     ▼                       │
│                                             ┌─────────────┐                 │
│                                             │elasticsearch│                 │
│                                             │   :9200     │                 │
│                                             │ (Internal)  │                 │
│                                             │ ⚠️ 외부 노출 X│                 │
│                                             └─────────────┘                 │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

접근 규칙:
┌────────────────────────────────────────────────────────────────┐
│ • External → Nginx (80/443)        ✅ 허용                      │
│ • Nginx → react-app (3000)         ✅ 허용                      │
│ • Nginx → spring-boot (8000)       ✅ 허용                      │
│ • Nginx → django (8001)            ✅ 허용                      │
│ • spring-boot → oracle-xe (1521)   ✅ 허용                      │
│ • spring-boot → django (8001)      ✅ 허용 (REST API)           │
│ • django → django-db (5432)        ✅ 허용                      │
│ • django → elasticsearch (9200)    ✅ 허용                      │
│ • External → oracle-xe             ❌ 차단                      │
│ • External → elasticsearch         ❌ 차단                      │
│ • spring-boot → elasticsearch      ❌ 차단 (Django 경유)        │
└────────────────────────────────────────────────────────────────┘
6. 보안 아키텍처
6.1 보안 계층도
┌─────────────────────────────────────────────────────────────────────────────┐
│                          SECURITY LAYERS                                     │
└─────────────────────────────────────────────────────────────────────────────┘

Layer 1: Frontend Security
┌─────────────────────────────────────────────────────────────────────────────┐
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                         React Application                             │  │
│  │  • XSS 방지: React 자동 이스케이핑                                     │  │
│  │  • HTTPS 전용 통신                                                    │  │
│  │  • localStorage JWT 저장 (httpOnly 쿠키 권장)                          │  │
│  │  • CSP (Content Security Policy) 헤더                                 │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
Layer 2: API Gateway Security
┌─────────────────────────────────────────────────────────────────────────────┐
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                              Nginx                                    │  │
│  │  • CORS 설정 (화이트리스트)                                            │  │
│  │  • Rate Limiting (100 req/min)                                        │  │
│  │  • SSL/TLS Termination                                                │  │
│  │  • Request Size Limit                                                 │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
Layer 3: Application Security
┌─────────────────────────────────────────────────────────────────────────────┐
│  ┌────────────────────────────────┐  ┌────────────────────────────────┐    │
│  │        Spring Boot             │  │           Django               │    │
│  │  • JWT 토큰 인증               │  │  • Django CSRF Protection      │    │
│  │  • Spring Security RBAC       │  │  • Spring 토큰 검증 (선택)     │    │
│  │  • Input Validation           │  │  • Input Validation            │    │
│  │  • Prepared Statements        │  │  • ES 내부망 전용 접근         │    │
│  │    (SQL Injection 방지)       │  │                                │    │
│  └────────────────────────────────┘  └────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
Layer 4: Data Security
┌─────────────────────────────────────────────────────────────────────────────┐
│  ┌───────────────────────────┐  ┌───────────────────────┐                  │
│  │         Oracle            │  │     Elasticsearch     │                  │
│  │  • BCrypt 비밀번호 해싱    │  │  • X-Pack Security    │                  │
│  │  • Row-level Security     │  │  • IP 화이트리스트    │                  │
│  │  • Spring Boot만 접근     │  │  • Django만 접근      │                  │
│  │  • Encrypted Connection   │  │  • 외부 노출 차단     │                  │
│  └───────────────────────────┘  └───────────────────────┘                  │
└─────────────────────────────────────────────────────────────────────────────┘
6.2 인증/인가 흐름
┌─────────────────────────────────────────────────────────────────────────────┐
│                      AUTHENTICATION / AUTHORIZATION FLOW                     │
└─────────────────────────────────────────────────────────────────────────────┘

    User           React          Spring Boot         Oracle
     │               │                 │                 │
     │ 로그인        │                 │                 │
     │ (email/PW)   │                 │                 │
     │──────────────▶│                 │                 │
     │               │ POST /api/auth │                 │
     │               │ /login         │                 │
     │               │───────────────▶│                 │
     │               │                 │ SELECT * FROM  │
     │               │                 │ users WHERE    │
     │               │                 │ email=?        │
     │               │                 │───────────────▶│
     │               │                 │◀───────────────│
     │               │                 │ User 정보      │
     │               │                 │                 │
     │               │                 │ ┌────────────────────────────────┐
     │               │                 │ │ 1. BCrypt 비밀번호 검증        │
     │               │                 │ │ 2. JWT Access Token 생성 (1h)  │
     │               │                 │ │ 3. JWT Refresh Token 생성 (7d) │
     │               │                 │ └────────────────────────────────┘
     │               │                 │                 │
     │               │◀───────────────│                 │
     │               │ { accessToken, │                 │
     │               │   refreshToken,│                 │
     │               │   user }       │                 │
     │               │                 │                 │
     │               │ localStorage에 │                 │
     │               │ 토큰 저장      │                 │
     │◀──────────────│                 │                 │
     │ 로그인 완료   │                 │                 │
     │               │                 │                 │
     │ ════════════════════════════════════════════════════
     │               │   이후 모든 API 요청에 토큰 포함     │
     │ ════════════════════════════════════════════════════
     │               │                 │                 │
     │ API 요청      │                 │                 │
     │──────────────▶│                 │                 │
     │               │ GET /api/      │                 │
     │               │ challenges     │                 │
     │               │ Authorization: │                 │
     │               │ Bearer {token} │                 │
     │               │───────────────▶│                 │
     │               │                 │ ┌────────────────────────────────┐
     │               │                 │ │ JWT 검증 (JwtAuthFilter)       │
     │               │                 │ │ 1. 서명 검증                   │
     │               │                 │ │ 2. 만료 시간 확인              │
     │               │                 │ │ 3. SecurityContext에 사용자 설정│
     │               │                 │ └────────────────────────────────┘
     │               │                 │                 │
     │               │                 │ ┌────────────────────────────────┐
     │               │                 │ │ 권한 검증 (@PreAuthorize)      │
     │               │                 │ │ • ROLE_USER                    │
     │               │                 │ │ • ROLE_LEADER                  │
     │               │                 │ │ • ROLE_ADMIN                   │
     │               │                 │ └────────────────────────────────┘
     │               │                 │                 │
     │               │                 │ SELECT * FROM  │
     │               │                 │ challenges     │
     │               │                 │───────────────▶│
     │               │                 │◀───────────────│
     │               │◀───────────────│                 │
     │               │ [챌린지 목록]   │                 │
     │◀──────────────│                 │                 │
     │ 결과 표시     │                 │                 │
7. 기술 스택 요약
7.1 기술 스택 매트릭스
┌─────────────────────────────────────────────────────────────────────────────┐
│                        TECHNOLOGY STACK MATRIX                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  LAYER            TECHNOLOGY           VERSION      PURPOSE                 │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  FRONTEND         React                18.2.0       SPA 웹 애플리케이션      │
│                   Vite                 5.4.x        빌드 도구                │
│                   React Router         6.x          클라이언트 라우팅        │
│                   Axios                1.6.5        HTTP 클라이언트          │
│                   Zustand              4.5.0        클라이언트 상태 관리     │
│                   React Query          5.17.19      서버 상태 관리           │
│                   Recharts             2.12.0       차트 시각화              │
│                   Tailwind CSS         3.4.1        스타일링                 │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  MAIN BACKEND     Spring Boot          3.2.3        REST API                 │
│                   Java                 21 (LTS)     Virtual Threads          │
│                   MyBatis              3.0.3        SQL 매핑                 │
│                   Spring Security      6.x          인증/인가                │
│                   Spring Retry         2.0.5        재시도 로직              │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  SUB BACKEND      Django               5.0.1        알고리즘/검색            │
│                   DRF                  3.14.0       REST API                 │
│                   Pandas               2.1.4        데이터 분석              │
│                   elasticsearch-py     8.11.1       ES 클라이언트            │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  DATABASE         Oracle               21c XE       메인 데이터베이스        │
│                   PostgreSQL           15           Django 로컬 DB          │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  SEARCH           Elasticsearch        8.11.3       검색/추천 엔진           │
│                   Nori Plugin          8.11.3       한글 형태소 분석         │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  INFRA            Docker               Latest       컨테이너화               │
│                   Nginx                1.25.3       리버스 프록시            │
│                   AWS EC2              t3.large     호스팅                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
7.2 API 분배 현황
┌─────────────────────────────────────────────────────────────────────────────┐
│                          API DISTRIBUTION                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  BACKEND          DOMAIN                  API COUNT    API NUMBERS          │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  SPRING BOOT      AUTH                    8            001-008               │
│  (83 APIs)        USER                    6            009-014               │
│                   ACCOUNT                 7            015-021               │
│                   CHALLENGE               8            022-029               │
│                   CHALLENGE FOLLOWER      5            030-034               │
│                   MEETING                 6            035-040               │
│                   VOTE                    5            041-045               │
│                   EXPENSE                 6            046-051               │
│                   LEDGER                  5            052-056               │
│                   POST                    9            057-065               │
│                   COMMENT                 6            066-071               │
│                   REPORT                  2            072-073               │
│                   NOTIFICATION            5            074-078               │
│                   REFUND                  2            079-080               │
│                   SETTLEMENT              2            081-082               │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  DJANGO           SEARCH                  3            083-085               │
│  (9 APIs)         ANALYTICS               4            086-089               │
│                   RECOMMENDATION          2            090-091               │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                              │
│  TOTAL                                    92 APIs                            │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
8. 동시성 제어 전략
8.1 Hybrid Lock Strategy
┌─────────────────────────────────────────────────────────────────────────────┐
│                      CONCURRENCY CONTROL STRATEGY                            │
│                         (Hybrid High-End)                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    JDK 21 Virtual Threads                            │    │
│  │  • 높은 동시성 처리 (수천 개 동시 요청)                               │    │
│  │  • 경량 스레드로 메모리 효율성                                        │    │
│  │  • 블로킹 I/O에서도 성능 유지                                         │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                      +                                       │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    Hybrid Lock 전략                                  │    │
│  │                                                                      │    │
│  │  ┌────────────────────────────┐  ┌────────────────────────────┐     │    │
│  │  │     Optimistic Lock        │  │     Pessimistic Lock       │     │    │
│  │  │  (낙관적 잠금)              │  │  (비관적 잠금)              │     │    │
│  │  │                            │  │                            │     │    │
│  │  │  적용 대상:                │  │  적용 대상:                │     │    │
│  │  │  • accounts (version)     │  │  • challenges              │     │    │
│  │  │                            │  │  • meeting_votes           │     │    │
│  │  │  특징:                     │  │  • expense_votes           │     │    │
│  │  │  • 충돌 감지 후 재시도     │  │  • general_votes           │     │    │
│  │  │  • Spring Retry 연동      │  │  • ledger_entries          │     │    │
│  │  │  • 높은 동시성 처리        │  │  • payment_barcodes        │     │    │
│  │  │                            │  │                            │     │    │
│  │  │  구현:                     │  │  특징:                     │     │    │
│  │  │  • version 컬럼 사용      │  │  • SELECT FOR UPDATE       │     │    │
│  │  │  • @Version 어노테이션    │  │  • 충돌 원천 방지           │     │    │
│  │  │                            │  │  • 금융 트랜잭션에 적합    │     │    │
│  │  └────────────────────────────┘  └────────────────────────────┘     │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    Spring Retry 설정                                 │    │
│  │  @Retryable(                                                        │    │
│  │      retryFor = { OptimisticLockException.class },                  │    │
│  │      maxAttempts = 3,                                               │    │
│  │      backoff = @Backoff(delay = 100, multiplier = 2)                │    │
│  │  )                                                                  │    │
│  │  재시도 간격: 100ms → 200ms → 400ms                                  │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                    트랜잭션 격리 수준                                 │    │
│  │  • Level: READ_COMMITTED                                            │    │
│  │  • Lock Timeout: 30초                                               │    │
│  │  • Statement Timeout: 60초                                          │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
9. 확장 계획 (Phase 2)
9.1 마이크로서비스 분리 계획
┌─────────────────────────────────────────────────────────────────────────────┐
│                      PHASE 2: MICROSERVICES ARCHITECTURE                     │
└─────────────────────────────────────────────────────────────────────────────┘

Current (Monolith)                   Future (Microservices)
┌─────────────────────┐              ┌─────────────────────┐
│                     │              │   API Gateway       │
│   Spring Boot       │              │   (Kong/Nginx)      │
│   (All Services)    │              └─────────────────────┘
│                     │                         │
│  • Challenge        │              ┌──────────┼──────────┐
│  • Vote             │              │          │          │
│  • Payment          │              ▼          ▼          ▼
│  • User             │         ┌────────┐ ┌────────┐ ┌────────┐
│  • SNS              │         │Challenge│ │  Vote  │ │Payment │
│                     │         │Service │ │Service │ │Service │
└─────────────────────┘         └────────┘ └────────┘ └────────┘
         │                           │          │          │
         │                           └──────────┼──────────┘
         │                                      │
         ▼                                      ▼
┌─────────────────────┐              ┌─────────────────────┐
│   Oracle (Single)   │              │   Kafka (Event Bus) │
└─────────────────────┘              └─────────────────────┘
                                               │
                                     ┌─────────┼─────────┐
                                     ▼         ▼         ▼
                                ┌────────┐ ┌────────┐ ┌────────┐
                                │Oracle  │ │Oracle  │ │Oracle  │
                                │(Shard1)│ │(Shard2)│ │(Shard3)│
                                └────────┘ └────────┘ └────────┘
10. 변경 이력
┌──────────┬────────────┬──────────┬─────────────────────────────────────────┐
│ 버전      │ 날짜        │ 작성자    │ 변경 내용                                │
├──────────┼────────────┼──────────┼─────────────────────────────────────────┤
│ 1.0.0    │ 2026-01-16 │ System   │ 초기 버전 생성                           │
│          │            │          │ - SYSTEM_ARCHITECTURE.md v3.0 기반       │
│          │            │          │ - 전체 시스템 구조도 (Mermaid + ASCII)   │
│          │            │          │ - 3-Tier 아키텍처 상세                   │
│          │            │          │ - 데이터 플로우 다이어그램 5종            │
│          │            │          │ - 배포 아키텍처 (Docker Compose)         │
│          │            │          │ - 보안 아키텍처 4계층                    │
│          │            │          │ - 동시성 제어 전략 (Hybrid Lock)         │
│          │            │          │ - 기술 스택 매트릭스                     │
│          │            │          │ - API 분배 현황 (92개)                   │
└──────────┴────────────┴──────────┴─────────────────────────────────────────┘
END OF DOCUMENT