================================================================================
WOORIDO 테스트 케이스 명세서
================================================================================

버전            1.0.0
작성일          2026-01-16
기준 문서       API_SCHEMA_1.0.0.md, POLICY_DEFINITION.md, DB_Schema_1.0.0.md
총 테스트       199개

================================================================================
목차
================================================================================

1. 개요
2. API 단위 테스트 (92개)
3. 정책 테스트 (61개)
4. 권한 테스트 (21개)
5. E2E 플로우 테스트 (10개)
6. 경계값/예외 테스트 (15개)

================================================================================
1. 개요
================================================================================

1.1 목적
--------
WOORIDO 서비스의 모든 기능이 정책 및 요구사항에 맞게 동작하는지 검증

1.2 테스트 범위
---------------
구분                  항목 수     설명
─────────────────     ─────────   ──────────────────────────────
API 단위 테스트       92          각 API별 정상/에러 케이스
정책 테스트           61          P-001 ~ P-061 정책 검증
권한 테스트           21          PM-001 ~ PM-021 권한 정책
E2E 플로우 테스트     10          주요 사용자 시나리오
경계값/예외 테스트    15          한계값 및 예외 상황
─────────────────     ─────────   ──────────────────────────────
합계                  199

1.3 용어 정의
-------------
용어              정의
────────────      ──────────────────────────────────────────
챌린지            challenges 테이블, 모임/계 단위
멤버              챌린지 내 전체 인원 (리더 + 팔로워)
리더              챌린지 생성자, 관리 권한 보유
팔로워            리더가 아닌 일반 멤버
당도(Brix)        사용자 신뢰도 점수 (기본값 12, 상한 80)
서포트            매월 납입하는 금액
보증금 락         챌린지 가입 시 잠기는 예치금

1.4 테스트 ID 규칙
------------------
형식: TC-{도메인}-{번호}

도메인 코드:
  AUTH      인증
  USER      사용자
  ACCT      계좌
  CHAL      챌린지
  MEMB      멤버
  MEET      모임
  VOTE      투표
  EXPN      지출
  LDGR      장부
  POST      게시글
  CMNT      댓글
  REPT      신고
  NOTI      알림
  RFND      환불
  STTL      정산
  SRCH      검색
  ANLY      분석
  RCMD      추천
  PLCY      정책
  PERM      권한
  E2E       E2E 플로우
  BNDRY     경계값


================================================================================
2. API 단위 테스트 (92개)
================================================================================

--------------------------------------------------------------------------------
2.1 AUTH API (8개)
--------------------------------------------------------------------------------

TC-AUTH-001: 회원가입 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/signup
전제조건        신규 이메일
입력값          email: test@example.com
                password: Test1234!@
                passwordConfirm: Test1234!@
                nickname: 테스트유저
                phone: 010-1234-5678
                agreedTerms: true
                agreedPrivacy: true
기대결과        201 Created
                userId 반환
                이메일 인증 메일 발송
검증항목        1. users 테이블에 레코드 생성
                2. accounts 테이블에 계좌 자동 생성
                3. user_scores 테이블에 기본 당도(12) 생성
                4. is_verified = 'N'

TC-AUTH-002: 회원가입 실패 - 이메일 중복
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/signup
전제조건        이미 가입된 이메일 존재
입력값          email: existing@example.com (기존 가입)
기대결과        409 Conflict
                USER_002: 이미 존재하는 이메일입니다
검증항목        1. 신규 레코드 생성되지 않음

TC-AUTH-003: 회원가입 실패 - 비밀번호 정책 위반
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/signup
전제조건        없음
입력값          password: 1234567 (7자, 숫자만)
기대결과        400 Bad Request
                VALIDATION_001: 비밀번호는 8자 이상, 영문+숫자 필수
검증항목        1. P-005 정책 적용 확인

TC-AUTH-004: 로그인 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/login
전제조건        가입된 사용자
입력값          email: test@example.com
                password: Test1234!@
기대결과        200 OK
                accessToken, refreshToken 반환
검증항목        1. last_login_at 갱신
                2. failed_login_attempts = 0 초기화

TC-AUTH-005: 로그인 실패 - 비밀번호 불일치
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/login
전제조건        가입된 사용자
입력값          email: test@example.com
                password: WrongPassword!@
기대결과        401 Unauthorized
                AUTH_001: 이메일 또는 비밀번호가 일치하지 않습니다
검증항목        1. failed_login_attempts 1 증가
                2. 5회 초과 시 locked_until 설정 (30분)

TC-AUTH-006: 로그인 실패 - 계정 잠금
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/login
전제조건        failed_login_attempts >= 5
                locked_until > 현재시간
입력값          email: locked@example.com
                password: Test1234!@
기대결과        403 Forbidden
                USER_004: 계정이 잠겼습니다 (30분 후 해제)
검증항목        1. 올바른 비밀번호여도 로그인 불가

TC-AUTH-007: 로그아웃 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/logout
전제조건        로그인 상태
입력값          refreshToken: {유효한 토큰}
기대결과        200 OK
검증항목        1. refreshToken 무효화

TC-AUTH-008: 토큰 갱신 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /auth/refresh
전제조건        유효한 refreshToken
입력값          refreshToken: {유효한 토큰}
기대결과        200 OK
                새 accessToken 반환
검증항목        1. 기존 accessToken 무효화
                2. 새 accessToken 유효


--------------------------------------------------------------------------------
2.2 USER API (6개)
--------------------------------------------------------------------------------

TC-USER-001: 내 정보 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /users/me
전제조건        로그인 상태
입력값          Authorization: Bearer {accessToken}
기대결과        200 OK
                userId, email, nickname, profileImageUrl, brixScore 반환
검증항목        1. user_scores.total_score 포함

TC-USER-002: 내 정보 수정 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /users/me
전제조건        로그인 상태
입력값          nickname: 새닉네임
                bio: 자기소개 수정
기대결과        200 OK
검증항목        1. users.nickname 업데이트
                2. users.updated_at 갱신

TC-USER-003: 비밀번호 변경 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /users/me/password
전제조건        로그인 상태
입력값          currentPassword: Test1234!@
                newPassword: NewPass1234!@
                newPasswordConfirm: NewPass1234!@
기대결과        200 OK
검증항목        1. password_hash 변경
                2. 기존 비밀번호로 로그인 불가
                3. 새 비밀번호로 로그인 가능

TC-USER-004: 비밀번호 변경 실패 - 현재 비밀번호 불일치
──────────────────────────────────────────────────────────────────────────────
API             PUT /users/me/password
전제조건        로그인 상태
입력값          currentPassword: WrongPassword
기대결과        400 Bad Request
                USER_003: 현재 비밀번호가 일치하지 않습니다
검증항목        1. password_hash 변경되지 않음

TC-USER-005: 회원 탈퇴 정상
──────────────────────────────────────────────────────────────────────────────
API             DELETE /users/me
전제조건        로그인 상태, 참여 챌린지 없음
입력값          password: Test1234!@
기대결과        200 OK
검증항목        1. account_status = 'WITHDRAWN'
                2. 가입된 챌린지 있으면 탈퇴 불가

TC-USER-006: 닉네임 중복 체크 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /users/check-nickname
전제조건        없음
입력값          nickname: 새닉네임
기대결과        200 OK
                available: true/false
검증항목        1. 중복 시 available: false


--------------------------------------------------------------------------------
2.3 ACCOUNT API (7개)
--------------------------------------------------------------------------------

TC-ACCT-001: 내 계좌 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /accounts/me
전제조건        로그인 상태
입력값          없음
기대결과        200 OK
                balance, lockedBalance 반환
검증항목        1. accounts 테이블 데이터 일치

TC-ACCT-002: 거래 내역 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /accounts/me/transactions
전제조건        로그인 상태
입력값          page: 0, size: 20
기대결과        200 OK
                거래 내역 목록 반환
검증항목        1. 최신순 정렬
                2. 페이지네이션 동작

TC-ACCT-003: 크레딧 충전 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /accounts/charge
전제조건        로그인 상태
입력값          amount: 50000
기대결과        200 OK
                paymentUrl 반환
검증항목        1. sessions 테이블에 CHARGE 세션 생성
                2. PG 결제 URL 반환

TC-ACCT-004: 크레딧 충전 실패 - 최소 금액 미만
──────────────────────────────────────────────────────────────────────────────
API             POST /accounts/charge
전제조건        로그인 상태
입력값          amount: 5000 (최소 10,000원)
기대결과        400 Bad Request
                ACCOUNT_002: 충전 금액은 10,000원 이상이어야 합니다
검증항목        1. P-006 정책 적용

TC-ACCT-005: 출금 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /accounts/withdraw
전제조건        로그인 상태, 가용 잔액 100,000원
입력값          amount: 50000
                bankCode: 088
                accountNumber: 123-456-789
기대결과        200 OK
검증항목        1. balance 50,000원 차감
                2. account_transactions에 WITHDRAW 기록
                3. lockedBalance는 차감 안됨

TC-ACCT-006: 출금 실패 - 잔액 부족
──────────────────────────────────────────────────────────────────────────────
API             POST /accounts/withdraw
전제조건        가용 잔액 10,000원
입력값          amount: 50000
기대결과        400 Bad Request
                ACCOUNT_003: 출금 가능 금액을 초과했습니다
검증항목        1. balance 변동 없음

TC-ACCT-007: 서포트 수동 납입 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /accounts/support
전제조건        로그인 상태, 챌린지 가입 상태
입력값          challengeId: {챌린지ID}
                amount: 50000
기대결과        200 OK
검증항목        1. balance 차감
                2. challenges.balance 증가
                3. ledger_entries에 SUPPORT 기록


--------------------------------------------------------------------------------
2.4 CHALLENGE API (8개)
--------------------------------------------------------------------------------

TC-CHAL-001: 챌린지 생성 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges
전제조건        로그인 상태
입력값          name: 저축 챌린지
                description: 함께 저축해요
                category: SAVINGS
                monthlyFee: 50000
                depositAmount: 100000
                minFollowers: 3
                maxFollowers: 20
기대결과        201 Created
검증항목        1. challenges 테이블 생성
                2. challenge_members에 리더로 자동 가입
                3. status = 'RECRUITING'
                4. current_members = 1

TC-CHAL-002: 챌린지 생성 실패 - 리더 한도 초과
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges
전제조건        이미 3개 챌린지 리더
입력값          (정상 데이터)
기대결과        400 Bad Request
                CHALLENGE_007: 리더당 챌린지 생성 한도(3개) 초과
검증항목        1. 챌린지 생성되지 않음

TC-CHAL-003: 챌린지 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges
전제조건        로그인 상태
입력값          category: SAVINGS
                status: RECRUITING
                page: 0
                size: 20
기대결과        200 OK
검증항목        1. is_public = 'Y'인 챌린지만 조회
                2. 필터 조건 적용

TC-CHAL-004: 챌린지 상세 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}
전제조건        공개 챌린지 존재
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. 챌린지 상세 정보 반환
                2. 멤버 수, 잔액 등 포함

TC-CHAL-005: 챌린지 수정 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /challenges/{challengeId}
전제조건        로그인 상태, 리더 권한
입력값          description: 수정된 설명
기대결과        200 OK
검증항목        1. challenges.description 업데이트
                2. updated_at 갱신

TC-CHAL-006: 챌린지 수정 실패 - 권한 없음
──────────────────────────────────────────────────────────────────────────────
API             PUT /challenges/{challengeId}
전제조건        로그인 상태, 팔로워 권한
입력값          description: 수정 시도
기대결과        403 Forbidden
                CHALLENGE_004: 리더만 수행할 수 있습니다
검증항목        1. 데이터 변경 없음

TC-CHAL-007: 챌린지 삭제 정상
──────────────────────────────────────────────────────────────────────────────
API             DELETE /challenges/{challengeId}
전제조건        리더 권한, status = 'RECRUITING'
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. deleted_at 설정 (Soft Delete)
                2. IN_PROGRESS 상태에서는 삭제 불가

TC-CHAL-008: 내 챌린지 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/me
전제조건        로그인 상태, 챌린지 가입 상태
입력값          없음
기대결과        200 OK
검증항목        1. 가입한 챌린지 목록 반환
                2. role 정보 포함 (LEADER/FOLLOWER)


--------------------------------------------------------------------------------
2.5 CHALLENGE MEMBER API (5개)
--------------------------------------------------------------------------------

TC-MEMB-001: 챌린지 가입 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/join
전제조건        로그인 상태, 가용 잔액 충분
입력값          challengeId: {RECRUITING 상태 챌린지}
기대결과        200 OK
검증항목        1. challenge_members에 FOLLOWER로 추가
                2. balance에서 서포트+보증금 차감
                3. lockedBalance에 보증금 락
                4. challenges.current_members 1 증가
                5. 최소 인원 충족 시 status → IN_PROGRESS

TC-MEMB-002: 챌린지 가입 실패 - 잔액 부족
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/join
전제조건        가용 잔액 부족
입력값          challengeId: {유효한 ID}
기대결과        400 Bad Request
                ACCOUNT_004: 잔액이 부족합니다
검증항목        1. 가입 처리 안됨

TC-MEMB-003: 챌린지 탈퇴 정상
──────────────────────────────────────────────────────────────────────────────
API             DELETE /challenges/{challengeId}/leave
전제조건        팔로워, 보증금 락 충족 상태
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. challenge_members.left_at 설정
                2. leave_reason = 'NORMAL'
                3. lockedBalance → balance 복구
                4. challenges.current_members 1 감소

TC-MEMB-004: 챌린지 탈퇴 실패 - 리더
──────────────────────────────────────────────────────────────────────────────
API             DELETE /challenges/{challengeId}/leave
전제조건        리더 권한
입력값          challengeId: {유효한 ID}
기대결과        400 Bad Request
                MEMBER_002: 리더는 탈퇴할 수 없습니다
검증항목        1. 탈퇴 처리 안됨
                2. 리더 위임 후 탈퇴 가능

TC-MEMB-005: 멤버 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/members
전제조건        챌린지 멤버
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. 멤버 목록 반환
                2. role, brixScore 포함
                3. 당도 순 정렬 옵션


--------------------------------------------------------------------------------
2.6 MEETING API (6개)
--------------------------------------------------------------------------------

TC-MEET-001: 모임 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/meetings
전제조건        챌린지 멤버
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. 모임 목록 반환
                2. status별 필터링

TC-MEET-002: 모임 생성 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/meetings
전제조건        리더 권한, IN_PROGRESS 상태
입력값          title: 1월 정기 모임
                meetingDate: 2026-01-25T18:00:00
                location: 서울 강남역
기대결과        201 Created
검증항목        1. meetings 테이블 생성
                2. meeting_votes 테이블 생성 (status: PENDING)
                3. 멤버들에게 알림 발송

TC-MEET-003: 모임 생성 실패 - 권한 없음
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/meetings
전제조건        팔로워 권한
입력값          (정상 데이터)
기대결과        403 Forbidden
                CHALLENGE_004: 리더만 수행할 수 있습니다
검증항목        1. 모임 생성 안됨

TC-MEET-004: 참석 의사 표시 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /meetings/{meetingId}/attendance
전제조건        챌린지 멤버, 투표 진행 중
입력값          choice: AGREE
기대결과        200 OK
검증항목        1. meeting_vote_records 생성
                2. meeting_votes.attend_count 증가
                3. 과반수 도달 시 meetings.status → CONFIRMED

TC-MEET-005: 참석 의사 표시 실패 - 권한 박탈
──────────────────────────────────────────────────────────────────────────────
API             POST /meetings/{meetingId}/attendance
전제조건        privilege_status = 'REVOKED'
입력값          choice: AGREE
기대결과        403 Forbidden
                VOTE_003: 투표 권한이 없습니다
검증항목        1. P-045 정책 적용
                2. 투표 기록 생성 안됨

TC-MEET-006: 모임 완료 처리 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /meetings/{meetingId}/complete
전제조건        리더 권한, status = 'CONFIRMED'
입력값          attendees: [{userId, status: ATTENDED/NO_SHOW}]
기대결과        200 OK
검증항목        1. meetings.status → COMPLETED
                2. meeting_vote_records.actual_attendance 업데이트
                3. ATTENDED: user_scores +0.09
                4. NO_SHOW: user_scores -0.09 (P-054)


--------------------------------------------------------------------------------
2.7 VOTE API (5개)
--------------------------------------------------------------------------------

TC-VOTE-001: 투표 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/votes
전제조건        챌린지 멤버
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. general_votes 목록 반환
                2. type별 필터링

TC-VOTE-002: 투표 생성 정상 - 팔로워 강퇴
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/votes
전제조건        리더 권한
입력값          type: KICK
                targetUserId: {대상 ID}
                title: 팔로워 강퇴 투표
                description: 무단 이탈 사유
기대결과        201 Created
검증항목        1. general_votes 생성
                2. required_count = eligible_count * 0.7 (70%)
                3. 대상자는 투표 자격 제외

TC-VOTE-003: 투표하기 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /votes/{voteId}/cast
전제조건        투표 자격자, 투표 진행 중
입력값          choice: APPROVE
기대결과        200 OK
검증항목        1. general_vote_records 생성
                2. approve_count 증가
                3. 조건 충족 시 status 변경

TC-VOTE-004: 투표하기 실패 - 이미 투표함
──────────────────────────────────────────────────────────────────────────────
API             PUT /votes/{voteId}/cast
전제조건        이미 투표 완료
입력값          choice: REJECT
기대결과        409 Conflict
                VOTE_006: 이미 투표하셨습니다
검증항목        1. 중복 투표 방지

TC-VOTE-005: 투표 결과 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /votes/{voteId}/result
전제조건        투표 종료
입력값          voteId: {유효한 ID}
기대결과        200 OK
검증항목        1. approve_count, reject_count 반환
                2. 투표 기록 목록


--------------------------------------------------------------------------------
2.8 EXPENSE API (6개)
--------------------------------------------------------------------------------

TC-EXPN-001: 지출 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/expenses
전제조건        챌린지 멤버
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. expense_requests 목록 반환

TC-EXPN-002: 지출 요청 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/expenses
전제조건        리더 권한
입력값          title: 식비
                amount: 50000
                meetingId: {모임 ID}
                description: 1월 모임 식비
기대결과        201 Created
검증항목        1. expense_requests 생성
                2. expense_votes 생성
                3. 참석자에게만 투표 알림

TC-EXPN-003: 지출 요청 실패 - 잔액 초과
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/expenses
전제조건        challenges.balance < amount
입력값          amount: 1000000 (잔액 초과)
기대결과        400 Bad Request
                EXPENSE_004: 지출 금액이 잔액을 초과합니다
검증항목        1. 지출 요청 생성 안됨

TC-EXPN-004: 지출 투표 정상 - 참석자
──────────────────────────────────────────────────────────────────────────────
API             PUT /expenses/{expenseId}/vote
전제조건        모임 참석자
입력값          choice: APPROVE
기대결과        200 OK
검증항목        1. expense_vote_records 생성
                2. 참석자 과반수 승인 시 status → APPROVED

TC-EXPN-005: 지출 투표 실패 - 미참석자
──────────────────────────────────────────────────────────────────────────────
API             PUT /expenses/{expenseId}/vote
전제조건        모임 미참석자
입력값          choice: APPROVE
기대결과        403 Forbidden
                VOTE_003: 투표 권한이 없습니다
검증항목        1. P-044 정책 적용

TC-EXPN-006: 지출 실행 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /expenses/{expenseId}/execute
전제조건        status = 'APPROVED'
입력값          없음
기대결과        200 OK
검증항목        1. payment_barcodes 생성 (10분 유효, P-053)
                2. expense_requests.status → EXECUTING


--------------------------------------------------------------------------------
2.9 LEDGER API (5개)
--------------------------------------------------------------------------------

TC-LDGR-001: 장부 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/ledger
전제조건        챌린지 멤버
입력값          page: 0, size: 20
기대결과        200 OK
검증항목        1. ledger_entries 목록 반환
                2. 최신순 정렬

TC-LDGR-002: 장부 요약 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/ledger/summary
전제조건        챌린지 멤버
입력값          없음
기대결과        200 OK
검증항목        1. 총 수입/지출/잔액 반환
                2. 월별 통계

TC-LDGR-003: 장부 내보내기 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/ledger/export
전제조건        챌린지 멤버
입력값          format: CSV
기대결과        200 OK
                파일 다운로드
검증항목        1. CSV 형식 반환
                2. 전체 거래 내역 포함

TC-LDGR-004: 장부 등록 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/ledger
전제조건        리더 권한
입력값          type: EXPENSE
                amount: 30000
                description: 기타 지출
기대결과        201 Created
검증항목        1. ledger_entries 생성
                2. challenges.balance 차감

TC-LDGR-005: 장부 수정 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /ledger/{entryId}
전제조건        리더 권한
입력값          memo: 수정된 메모
기대결과        200 OK
검증항목        1. ledger_entries.memo 업데이트
                2. memo_updated_at, memo_updated_by 갱신


--------------------------------------------------------------------------------
2.10 POST API (9개)
--------------------------------------------------------------------------------

TC-POST-001: 피드 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /posts/feed
전제조건        로그인 상태
입력값          page: 0, size: 20
기대결과        200 OK
검증항목        1. 가입한 챌린지 게시글 통합 피드
                2. 최신순 정렬

TC-POST-002: 챌린지 게시글 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/posts
전제조건        챌린지 멤버
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. is_pinned = 'Y' 상단 고정
                2. is_notice = 'Y' 공지 표시

TC-POST-003: 게시글 작성 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/posts
전제조건        챌린지 멤버
입력값          title: 오늘의 저축 인증
                content: 5만원 저축했습니다!
                category: GENERAL
기대결과        201 Created
검증항목        1. posts 테이블 생성
                2. 리더 활동 시 leader_last_active_at 갱신

TC-POST-004: 게시글 수정 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /posts/{postId}
전제조건        작성자 본인
입력값          content: 수정된 내용
기대결과        200 OK
검증항목        1. posts.content 업데이트
                2. updated_at 갱신

TC-POST-005: 게시글 수정 실패 - 권한 없음
──────────────────────────────────────────────────────────────────────────────
API             PUT /posts/{postId}
전제조건        다른 사용자
입력값          content: 수정 시도
기대결과        403 Forbidden
                POST_003: 게시글 작성자만 가능합니다
검증항목        1. 변경 없음

TC-POST-006: 게시글 삭제 정상
──────────────────────────────────────────────────────────────────────────────
API             DELETE /posts/{postId}
전제조건        작성자 본인
입력값          없음
기대결과        200 OK
검증항목        1. posts.deleted_at 설정 (Soft Delete)

TC-POST-007: 게시글 좋아요 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /posts/{postId}/like
전제조건        로그인 상태
입력값          없음
기대결과        200 OK
검증항목        1. post_likes 생성
                2. posts.like_count 1 증가

TC-POST-008: 게시글 좋아요 취소 정상
──────────────────────────────────────────────────────────────────────────────
API             DELETE /posts/{postId}/like
전제조건        좋아요 상태
입력값          없음
기대결과        200 OK
검증항목        1. post_likes 삭제
                2. posts.like_count 1 감소

TC-POST-009: 이미지 업로드 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /upload/image
전제조건        로그인 상태
입력값          file: image.jpg (5MB)
기대결과        200 OK
                imageUrl 반환
검증항목        1. S3 업로드 완료
                2. CDN URL 반환


--------------------------------------------------------------------------------
2.11 COMMENT API (6개)
--------------------------------------------------------------------------------

TC-CMNT-001: 댓글 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /posts/{postId}/comments
전제조건        게시글 접근 권한
입력값          postId: {유효한 ID}
기대결과        200 OK
검증항목        1. 댓글 목록 반환
                2. 대댓글 포함 (parent_id)

TC-CMNT-002: 댓글 작성 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /posts/{postId}/comments
전제조건        로그인 상태
입력값          content: 좋은 글이네요!
기대결과        201 Created
검증항목        1. comments 테이블 생성
                2. posts.comment_count 1 증가
                3. 작성자에게 알림

TC-CMNT-003: 대댓글 작성 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /posts/{postId}/comments
전제조건        로그인 상태
입력값          content: 답글입니다
                parentId: {부모 댓글 ID}
기대결과        201 Created
검증항목        1. comments.parent_id 설정
                2. 부모 댓글 작성자에게 알림

TC-CMNT-004: 댓글 수정 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /comments/{commentId}
전제조건        작성자 본인
입력값          content: 수정된 댓글
기대결과        200 OK
검증항목        1. comments.content 업데이트

TC-CMNT-005: 댓글 삭제 정상
──────────────────────────────────────────────────────────────────────────────
API             DELETE /comments/{commentId}
전제조건        작성자 본인
입력값          없음
기대결과        200 OK
검증항목        1. comments.deleted_at 설정
                2. posts.comment_count 1 감소

TC-CMNT-006: 댓글 좋아요 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /comments/{commentId}/like
전제조건        로그인 상태
입력값          없음
기대결과        200 OK
검증항목        1. comment_likes 생성
                2. comments.like_count 1 증가


--------------------------------------------------------------------------------
2.12 REPORT API (2개)
--------------------------------------------------------------------------------

TC-REPT-001: 신고 접수 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /reports
전제조건        로그인 상태
입력값          reportedEntityType: POST
                reportedEntityId: {게시글 ID}
                reasonCategory: SPAM
                reasonDetail: 광고성 게시글
기대결과        201 Created
검증항목        1. reports 테이블 생성
                2. status = 'PENDING'
                3. 동일 대상 중복 신고 방지 (1계정 1회)

TC-REPT-002: 내 신고 내역 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /reports/me
전제조건        로그인 상태
입력값          page: 0, size: 20
기대결과        200 OK
검증항목        1. 본인이 신고한 내역만 반환


--------------------------------------------------------------------------------
2.13 NOTIFICATION API (5개)
--------------------------------------------------------------------------------

TC-NOTI-001: 알림 목록 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /notifications
전제조건        로그인 상태
입력값          page: 0, size: 20
기대결과        200 OK
검증항목        1. 최신순 정렬
                2. is_read 상태 포함

TC-NOTI-002: 알림 읽음 처리 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /notifications/{notificationId}/read
전제조건        본인 알림
입력값          notificationId: {유효한 ID}
기대결과        200 OK
검증항목        1. is_read = 'Y'
                2. read_at 설정

TC-NOTI-003: 전체 읽음 처리 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /notifications/read-all
전제조건        로그인 상태
입력값          없음
기대결과        200 OK
검증항목        1. 모든 알림 is_read = 'Y'

TC-NOTI-004: 알림 설정 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /notifications/settings
전제조건        로그인 상태
입력값          없음
기대결과        200 OK
검증항목        1. notification_settings 반환

TC-NOTI-005: 알림 설정 변경 정상
──────────────────────────────────────────────────────────────────────────────
API             PUT /notifications/settings
전제조건        로그인 상태
입력값          pushEnabled: true
                emailEnabled: false
                voteNotification: true
기대결과        200 OK
검증항목        1. notification_settings 업데이트


--------------------------------------------------------------------------------
2.14 REFUND API (2개)
--------------------------------------------------------------------------------

TC-RFND-001: 환불 요청 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /refunds
전제조건        로그인 상태
입력값          amount: 50000
                reasonCategory: USER_REQUEST
                reasonDetail: 개인 사정
기대결과        200 OK
검증항목        1. refunds 테이블 생성
                2. status = 'REQUESTED'

TC-RFND-002: 환불 상태 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /refunds/{refundId}
전제조건        본인 환불 요청
입력값          refundId: {유효한 ID}
기대결과        200 OK
검증항목        1. 환불 상태 반환


--------------------------------------------------------------------------------
2.15 SETTLEMENT API (2개)
--------------------------------------------------------------------------------

TC-STTL-001: 챌린지 정산 정상
──────────────────────────────────────────────────────────────────────────────
API             POST /challenges/{challengeId}/settle
전제조건        리더 권한, status = 'COMPLETED'
입력값          없음
기대결과        200 OK
검증항목        1. settlements 테이블 생성
                2. 잔액 멤버 N등분 분배
                3. 각 멤버 balance 증가

TC-STTL-002: 정산 내역 조회 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /challenges/{challengeId}/settlement
전제조건        챌린지 멤버
입력값          없음
기대결과        200 OK
검증항목        1. 정산 내역 반환
                2. 멤버별 분배 금액


--------------------------------------------------------------------------------
2.16 SEARCH API - Django (3개)
--------------------------------------------------------------------------------

TC-SRCH-001: 통합 검색 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /search
전제조건        로그인 상태
입력값          q: 저축
                type: ALL
기대결과        200 OK
검증항목        1. challenges, posts, users 통합 결과
                2. 검색어 2자 이상

TC-SRCH-002: 챌린지 상세 검색 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /search/challenges
전제조건        로그인 상태
입력값          q: 여행
                category: TRAVEL
                status: RECRUITING
기대결과        200 OK
검증항목        1. 필터 조건 적용
                2. relevanceScore 포함

TC-SRCH-003: 검색어 자동완성 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /search/autocomplete
전제조건        로그인 상태
입력값          q: 저
                limit: 10
기대결과        200 OK
검증항목        1. 자동완성 제안 목록
                2. 1자 이상 입력


--------------------------------------------------------------------------------
2.17 ANALYTICS API - Django (4개)
--------------------------------------------------------------------------------

TC-ANLY-001: 내 활동 통계 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /analytics/user/activity
전제조건        로그인 상태
입력값          period: MONTH
기대결과        200 OK
검증항목        1. summary, dailyTrend, ranking 반환

TC-ANLY-002: 챌린지 분석 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /analytics/challenge/{challengeId}
전제조건        챌린지 멤버
입력값          challengeId: {유효한 ID}
기대결과        200 OK
검증항목        1. overview, trends, followerAnalysis 반환
                2. predictions 포함

TC-ANLY-003: 대시보드 데이터 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /analytics/dashboard
전제조건        로그인 상태
입력값          없음
기대결과        200 OK
검증항목        1. userStats, challengeStats, financialStats 반환

TC-ANLY-004: 월간 리포트 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /analytics/user/report
전제조건        로그인 상태
입력값          period: MONTH
                format: PDF
기대결과        200 OK
검증항목        1. downloadUrl 반환


--------------------------------------------------------------------------------
2.18 RECOMMENDATION API - Django (2개)
--------------------------------------------------------------------------------

TC-RCMD-001: 챌린지 추천 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /recommendations/challenges
전제조건        로그인 상태
입력값          limit: 10
기대결과        200 OK
검증항목        1. matchScore 기준 정렬
                2. 가입한 챌린지 제외

TC-RCMD-002: 유사 사용자 추천 정상
──────────────────────────────────────────────────────────────────────────────
API             GET /recommendations/users
전제조건        로그인 상태
입력값          limit: 10
기대결과        200 OK
검증항목        1. 유사 활동 패턴 기반 추천


================================================================================
3. 정책 테스트 (61개)
================================================================================

--------------------------------------------------------------------------------
3.1 회원가입 정책 (P-001 ~ P-005)
--------------------------------------------------------------------------------

TC-PLCY-001: P-001 개인정보 처리 방침 필수 동의
──────────────────────────────────────────────────────────────────────────────
정책            P-001 회원가입 정책 - 약관 동의
테스트 내용     agreedPrivacy = false로 회원가입 시도
기대결과        400 Bad Request
검증항목        1. 필수 동의 없이 가입 불가

TC-PLCY-002: P-002 마케팅 정보 선택 동의
──────────────────────────────────────────────────────────────────────────────
정책            P-002 회원가입 정책 - 마케팅 동의
테스트 내용     agreedMarketing = false로 회원가입 시도
기대결과        201 Created
검증항목        1. 마케팅 미동의해도 가입 가능

TC-PLCY-003: P-003 이름 2~10자 제한
──────────────────────────────────────────────────────────────────────────────
정책            P-003 회원가입 정책 - 이름
테스트 내용     name = "김" (1자) 또는 "김철수철수철수철수철" (11자)
기대결과        400 Bad Request
검증항목        1. 2~10자 범위 외 거부

TC-PLCY-004: P-004 이메일 중복 확인
──────────────────────────────────────────────────────────────────────────────
정책            P-004 회원가입 정책 - 이메일
테스트 내용     기존 가입 이메일로 회원가입 시도
기대결과        409 Conflict
검증항목        1. 중복 이메일 거부

TC-PLCY-005: P-005 비밀번호 8자 이상 영문+숫자
──────────────────────────────────────────────────────────────────────────────
정책            P-005 회원가입 정책 - 비밀번호
테스트 내용     password = "12345678" (숫자만) 또는 "abcdefgh" (영문만)
기대결과        400 Bad Request
검증항목        1. 영문+숫자 조합 필수


--------------------------------------------------------------------------------
3.2 크레딧 정책 (P-006 ~ P-012)
--------------------------------------------------------------------------------

TC-PLCY-006: P-006 최소 충전 금액 10,000원
──────────────────────────────────────────────────────────────────────────────
정책            P-006 크레딧 정책 - 최소 충전
테스트 내용     amount = 9,999원 충전 시도
기대결과        400 Bad Request
검증항목        1. 10,000원 미만 충전 불가

TC-PLCY-007: P-007 최대 충전 금액 1,000,000원
──────────────────────────────────────────────────────────────────────────────
정책            P-007 크레딧 정책 - 최대 충전
테스트 내용     amount = 1,000,001원 충전 시도
기대결과        400 Bad Request
검증항목        1. 단일 충전 한도 초과 불가

TC-PLCY-008: P-008 출금 가용 잔액 내
──────────────────────────────────────────────────────────────────────────────
정책            P-008 크레딧 정책 - 출금 가능 금액
테스트 내용     balance=50,000, lockedBalance=30,000일 때 60,000원 출금 시도
기대결과        400 Bad Request
검증항목        1. 가용 잔액(50,000) 초과 출금 불가
                2. lockedBalance는 출금 대상 아님

TC-PLCY-009: P-010 소액 충전 수수료 1%
──────────────────────────────────────────────────────────────────────────────
정책            P-010 수수료 정책 - 소액 충전
테스트 내용     9,999원 충전 시 수수료 확인 (해당 시나리오 없음, 최소 10,000원)
기대결과        N/A
검증항목        1. 최소 충전 금액으로 인해 소액 수수료 적용 불가

TC-PLCY-010: P-011 일반 충전 수수료 3%
──────────────────────────────────────────────────────────────────────────────
정책            P-011 수수료 정책 - 일반 충전
테스트 내용     100,000원 충전 시 수수료 3,000원 확인
기대결과        수수료 3% 적용
검증항목        1. 10,000~200,000원 구간 3% 수수료

TC-PLCY-011: P-012 고액 충전 수수료 1.5%
──────────────────────────────────────────────────────────────────────────────
정책            P-012 수수료 정책 - 고액 충전
테스트 내용     300,000원 충전 시 수수료 4,500원 확인
기대결과        수수료 1.5% 적용
검증항목        1. 200,001원 이상 구간 1.5% 수수료


--------------------------------------------------------------------------------
3.3 챌린지 가입/서포트 정책 (P-013 ~ P-017)
--------------------------------------------------------------------------------

TC-PLCY-012: P-013 가입 시 서포트+보증금+입회비
──────────────────────────────────────────────────────────────────────────────
정책            P-013 챌린지 가입 정책
테스트 내용     챌린지 가입 시 결제 금액 확인
기대결과        서포트 + 보증금 락 + 입회비(해당 시) 차감
검증항목        1. balance 차감
                2. lockedBalance 증가

TC-PLCY-013: P-014 잔액 조건 충족 필수
──────────────────────────────────────────────────────────────────────────────
정책            P-014 챌린지 가입 정책 - 잔액 조건
테스트 내용     서포트+보증금 미만 잔액으로 가입 시도
기대결과        400 Bad Request
검증항목        1. 잔액 부족 시 가입 불가

TC-PLCY-014: P-015 입회비 계산 및 귀속
──────────────────────────────────────────────────────────────────────────────
정책            P-015 입회비 정책
테스트 내용     ACTIVE 상태, 잔액 100,000원, 멤버 5명 챌린지 가입
기대결과        입회비 = 100,000 / (5-1) = 25,000원
검증항목        1. 입회비 계산 공식 적용
                2. challenges.balance에 합산
                3. RECRUITING 상태 시 입회비 없음

TC-PLCY-015: P-016 매월 1일 자동 납입
──────────────────────────────────────────────────────────────────────────────
정책            P-016 서포트 정책 - 자동 납입
테스트 내용     매월 1일 00:00 배치 실행
기대결과        자동 서포트 납입 처리
검증항목        1. 전체 IN_PROGRESS 챌린지 대상
                2. balance에서 서포트 차감
                3. challenges.balance 증가

TC-PLCY-016: P-017 잔액 부족 시 보증금 충당
──────────────────────────────────────────────────────────────────────────────
정책            P-017 서포트 정책 - 안심결제
테스트 내용     balance=0, lockedBalance=100,000일 때 서포트 납입
기대결과        lockedBalance에서 차감
검증항목        1. 보증금 충당 처리
                2. privilege_status → REVOKED


--------------------------------------------------------------------------------
3.4 보증금 정책 (P-018 ~ P-022, P-052, P-056)
--------------------------------------------------------------------------------

TC-PLCY-017: P-018 보증금 충당 시 즉시 권한 박탈
──────────────────────────────────────────────────────────────────────────────
정책            P-018 보증금 정책 - 권한 박탈
테스트 내용     보증금 충당 발생
기대결과        privilege_status = 'REVOKED'
검증항목        1. 즉시 권한 박탈
                2. privilege_revoked_at 설정

TC-PLCY-018: P-019 충전 시 보증금 1순위 복구
──────────────────────────────────────────────────────────────────────────────
정책            P-019 보증금 정책 - 복구 우선순위
테스트 내용     권한 박탈 상태에서 충전
기대결과        lockedBalance 먼저 복구
검증항목        1. balance보다 lockedBalance 우선 복구

TC-PLCY-019: P-020 보증금 충족 시 권한 복구
──────────────────────────────────────────────────────────────────────────────
정책            P-020 보증금 정책 - 권한 복구
테스트 내용     lockedBalance >= deposit_amount 충족
기대결과        privilege_status = 'ACTIVE'
검증항목        1. 즉시 권한 복구

TC-PLCY-020: P-021 7일 유예 후 모임 자동 제외
──────────────────────────────────────────────────────────────────────────────
정책            P-021 보증금 정책 - 유예 기간
테스트 내용     권한 박탈 후 7일 경과
기대결과        예정 모임 전체 자동 제외
검증항목        1. meeting_vote_records 삭제 또는 무효화

TC-PLCY-021: P-022 60일 미충전 시 자동 탈퇴
──────────────────────────────────────────────────────────────────────────────
정책            P-022 자동 탈퇴 정책
테스트 내용     보증금 충당 후 60일 경과 (미충전)
기대결과        자동 탈퇴 처리
검증항목        1. challenge_members.left_at 설정
                2. leave_reason = 'AUTO_LEAVE'

TC-PLCY-022: P-052 자동 탈퇴 시 보증금 몰수
──────────────────────────────────────────────────────────────────────────────
정책            P-052 보증금 몰수 정책
테스트 내용     AUTO_LEAVE로 탈퇴
기대결과        lockedBalance 몰수
검증항목        1. lockedBalance → 시스템 귀속
                2. NORMAL, KICKED 탈퇴는 반환

TC-PLCY-023: P-056 권한 복구 조건
──────────────────────────────────────────────────────────────────────────────
정책            P-056 권한 복구 정책
테스트 내용     lockedBalance >= deposit_amount 충족
기대결과        privilege_status → ACTIVE
검증항목        1. 충전과 동시에 자동 복구


--------------------------------------------------------------------------------
3.5 탈퇴 정책 (P-024 ~ P-025)
--------------------------------------------------------------------------------

TC-PLCY-024: P-024 보증금 충족 상태에서만 탈퇴 가능
──────────────────────────────────────────────────────────────────────────────
정책            P-024 정상 탈퇴 정책 - 조건
테스트 내용     보증금 부족 상태에서 탈퇴 시도
기대결과        400 Bad Request
검증항목        1. 탈퇴 불가

TC-PLCY-025: P-025 탈퇴 시 보증금 해제
──────────────────────────────────────────────────────────────────────────────
정책            P-025 정상 탈퇴 정책 - 보증금 처리
테스트 내용     정상 탈퇴 처리
기대결과        lockedBalance → balance 전환
검증항목        1. 보증금 락 해제
                2. 가용 잔액으로 전환


--------------------------------------------------------------------------------
3.6 완주/장부/바코드 정책 (P-026 ~ P-029, P-053)
--------------------------------------------------------------------------------

TC-PLCY-026: P-026 1년 연속 운영 시 완주 인증
──────────────────────────────────────────────────────────────────────────────
정책            P-026 완주 정책 - 인증 조건
테스트 내용     activated_at으로부터 365일 경과
기대결과        is_verified = 'Y'
검증항목        1. 배치로 자동 인증 처리

TC-PLCY-027: P-029 PG 결제 시 사용처 자동 기록
──────────────────────────────────────────────────────────────────────────────
정책            P-029 장부 정책 - 사용처 기록
테스트 내용     바코드 결제 완료 (PG 웹훅)
기대결과        merchant_name, merchant_category 자동 입력
검증항목        1. ledger_entries에 PG 정보 자동 기록
                2. 수동 수정 불가

TC-PLCY-028: P-053 바코드 10분 유효
──────────────────────────────────────────────────────────────────────────────
정책            P-053 바코드 유효 기간 정책
테스트 내용     바코드 발급 후 10분 경과
기대결과        status = 'EXPIRED'
검증항목        1. 자동 만료 처리
                2. 만료 후 사용 불가


--------------------------------------------------------------------------------
3.7 신고 정책 (P-030 ~ P-031, P-055)
--------------------------------------------------------------------------------

TC-PLCY-029: P-030 1계정 1회 신고
──────────────────────────────────────────────────────────────────────────────
정책            P-030 신고 정책 - 카운팅
테스트 내용     동일 대상 재신고 시도
기대결과        409 Conflict
검증항목        1. 중복 신고 불가

TC-PLCY-030: P-030 20회 누적 시 자동 정지
──────────────────────────────────────────────────────────────────────────────
정책            P-030 신고 정책 - 자동 정지
테스트 내용     피신고 20회 누적
기대결과        account_status = 'SUSPENDED'
검증항목        1. 자동 일시정지

TC-PLCY-031: P-055 허위 신고 제재
──────────────────────────────────────────────────────────────────────────────
정책            P-055 허위 신고 제재 정책
테스트 내용     허위 신고 3회 누적
기대결과        7일 계정 정지
검증항목        1. 1회: 경고
                2. 3회: 7일 정지
                3. 5회: 영구 정지 검토


--------------------------------------------------------------------------------
3.8 리더 정책 (P-033 ~ P-035, P-058)
--------------------------------------------------------------------------------

TC-PLCY-032: P-033 리더 30일 미활동 시 강퇴 요청 가능
──────────────────────────────────────────────────────────────────────────────
정책            P-033 리더 활동 정책
테스트 내용     leader_last_active_at이 30일 전
기대결과        LEADER_KICK 투표 생성 가능
검증항목        1. 팔로워가 강퇴 투표 발의 가능

TC-PLCY-033: P-034 리더 강퇴 시 점수 최고자 승계
──────────────────────────────────────────────────────────────────────────────
정책            P-034 리더 승계 정책
테스트 내용     LEADER_KICK 투표 70% 승인
기대결과        당도 최고자에게 리더 양도
검증항목        1. user_scores.total_score 기준
                2. 기존 리더 → FOLLOWER

TC-PLCY-034: P-058 리더 활동 갱신 시점
──────────────────────────────────────────────────────────────────────────────
정책            P-058 리더 활동 갱신 정책
테스트 내용     리더가 피드 작성
기대결과        leader_last_active_at = NOW
검증항목        1. 피드/공지 작성 시 갱신
                2. 투표 생성 시 갱신
                3. 댓글 작성 시 갱신
                4. 모임 생성 시 갱신
                5. 단순 로그인은 미갱신


--------------------------------------------------------------------------------
3.9 투표 정책 (P-037 ~ P-042)
--------------------------------------------------------------------------------

TC-PLCY-035: P-037 지출 투표 과반수 승인
──────────────────────────────────────────────────────────────────────────────
정책            P-037 지출 투표 정책
테스트 내용     5명 중 3명 APPROVE
기대결과        status = 'APPROVED'
검증항목        1. 50% + 1 = 과반수

TC-PLCY-036: P-038 멤버 퇴출 투표 70% 승인
──────────────────────────────────────────────────────────────────────────────
정책            P-038 멤버 퇴출 투표 정책
테스트 내용     10명 중 7명 APPROVE
기대결과        대상 멤버 강제 탈퇴
검증항목        1. 70% 이상 필요
                2. 보증금 반환

TC-PLCY-037: P-039 모임 참석 투표 과반수 참석 시 확정
──────────────────────────────────────────────────────────────────────────────
정책            P-039 정기 모임 참석 투표 정책
테스트 내용     10명 중 6명 AGREE
기대결과        meetings.status = 'CONFIRMED'
검증항목        1. 과반수 참석 → 모임 확정
                2. 미달 시 자동 취소

TC-PLCY-038: P-040 리더 강퇴 투표 70% 승인
──────────────────────────────────────────────────────────────────────────────
정책            P-040 리더 강퇴 투표 정책
테스트 내용     리더 30일 미활동 후 투표
기대결과        70% 승인 시 리더 교체
검증항목        1. 30일 미활동 조건 필수
                2. 점수 최고자 승계

TC-PLCY-039: P-041 챌린지 종료 투표 전원 동의
──────────────────────────────────────────────────────────────────────────────
정책            P-041 챌린지 종료 투표 정책
테스트 내용     10명 중 9명 APPROVE
기대결과        status 유지 (종료 안됨)
검증항목        1. 100% 전원 동의 필요
                2. 1명 반대 시 거부

TC-PLCY-040: P-042 모임 관련 지출 참석자만 투표
──────────────────────────────────────────────────────────────────────────────
정책            P-042 모임 관련 지출 투표 정책
테스트 내용     모임 미참석자가 지출 투표 시도
기대결과        403 Forbidden
검증항목        1. 참석자만 투표 가능
                2. 참석자 과반수 기준


--------------------------------------------------------------------------------
3.10 정기 모임 정책 (P-043 ~ P-045)
--------------------------------------------------------------------------------

TC-PLCY-041: P-043 과반수 참석 시 모임 개최
──────────────────────────────────────────────────────────────────────────────
정책            P-043 정기 모임 정책 - 개최 조건
테스트 내용     과반수 미달
기대결과        모임 자동 취소
검증항목        1. meetings.status = 'CANCELLED'

TC-PLCY-042: P-044 참석자만 지출 투표 가능
──────────────────────────────────────────────────────────────────────────────
정책            P-044 정기 모임 정책 - 지출 투표
테스트 내용     미참석자 투표 시도
기대결과        투표 참여 불가
검증항목        1. meeting_attendees 확인

TC-PLCY-043: P-045 권한 박탈 시 모임 참석 불가
──────────────────────────────────────────────────────────────────────────────
정책            P-045 정기 모임 정책 - 권한 제한
테스트 내용     privilege_status = 'REVOKED' 상태에서 참석 투표
기대결과        투표 불가
검증항목        1. 참석 투표 불가
                2. 지출 투표 불가


--------------------------------------------------------------------------------
3.11 챌린지 상태 정책 (P-046 ~ P-050, P-057)
--------------------------------------------------------------------------------

TC-PLCY-044: P-046 RECRUITING 상태 - 보증금 락 없음
──────────────────────────────────────────────────────────────────────────────
정책            P-046 챌린지 상태 정책 - RECRUITING
테스트 내용     RECRUITING 챌린지 가입
기대결과        보증금 락 없음
검증항목        1. lockedBalance 변동 없음

TC-PLCY-045: P-047 최소 3명 충족 시 ACTIVE 전환
──────────────────────────────────────────────────────────────────────────────
정책            P-047 챌린지 상태 정책 - ACTIVE 전환
테스트 내용     3번째 멤버 가입
기대결과        status = 'IN_PROGRESS'
검증항목        1. 자동 상태 전환
                2. activated_at 설정
                3. 전체 멤버 보증금 락

TC-PLCY-046: P-048 ACTIVE 상태 - 입회비 부과
──────────────────────────────────────────────────────────────────────────────
정책            P-048 챌린지 상태 정책 - ACTIVE
테스트 내용     ACTIVE + balance > 0 상태에서 신규 가입
기대결과        입회비 부과
검증항목        1. P-015 계산식 적용

TC-PLCY-047: P-049 DISSOLVE 전원 동의 시 CLOSED
──────────────────────────────────────────────────────────────────────────────
정책            P-049 챌린지 상태 정책 - CLOSED 전환
테스트 내용     DISSOLVE 투표 전원 동의
기대결과        status = 'COMPLETED'
검증항목        1. 100% 동의 필요

TC-PLCY-048: P-050 CLOSED 시 잔액 N등분 분배
──────────────────────────────────────────────────────────────────────────────
정책            P-050 챌린지 상태 정책 - CLOSED
테스트 내용     챌린지 종료 처리
기대결과        잔액 멤버 균등 분배
검증항목        1. 각 멤버 balance 증가
                2. challenges.balance = 0

TC-PLCY-049: P-057 PAUSED 상태 - 서포트 납입 중단
──────────────────────────────────────────────────────────────────────────────
정책            P-057 챌린지 상태 정책 - PAUSED
테스트 내용     PAUSED 상태에서 매월 1일
기대결과        서포트 납입 스킵
검증항목        1. 자동 납입 중단


--------------------------------------------------------------------------------
3.12 점수/Webhook 정책 (P-051, P-054, P-059, P-061)
--------------------------------------------------------------------------------

TC-PLCY-050: P-051 모임 참석 +0.09점
──────────────────────────────────────────────────────────────────────────────
정책            P-051 모임 참석 점수 정책
테스트 내용     actual_attendance = 'ATTENDED'
기대결과        user_scores.total_score +0.09
검증항목        1. 참석 시 점수 증가

TC-PLCY-051: P-054 NO_SHOW -0.09점
──────────────────────────────────────────────────────────────────────────────
정책            P-054 NO_SHOW 패널티 정책
테스트 내용     actual_attendance = 'NO_SHOW'
기대결과        user_scores.total_score -0.09
검증항목        1. 노쇼 시 점수 차감

TC-PLCY-052: P-059 Webhook 3회 재시도
──────────────────────────────────────────────────────────────────────────────
정책            P-059 Webhook 실패 정책
테스트 내용     PG 웹훅 처리 실패
기대결과        1분, 5분, 30분 간격 재시도
검증항목        1. payment_logs에 기록
                2. 최종 실패 시 관리자 알림

TC-PLCY-053: P-061 매월 1일 당도 배치 계산
──────────────────────────────────────────────────────────────────────────────
정책            P-061 점수 산정 정책
테스트 내용     매월 1일 00:00 배치 실행
기대결과        전체 사용자 당도 재계산
검증항목        1. Django 서버 실행
                2. Pessimistic Lock 사용


--------------------------------------------------------------------------------
3.13 알림/휴면 정책 (P-036, P-060)
--------------------------------------------------------------------------------

TC-PLCY-054: P-060 알림 설정 기본값
──────────────────────────────────────────────────────────────────────────────
정책            P-060 알림 정책
테스트 내용     신규 회원가입
기대결과        마케팅 제외 모두 ON
검증항목        1. notification_settings 기본값 확인

TC-PLCY-055: P-036 전원 탈퇴 시 잔액 시스템 귀속
──────────────────────────────────────────────────────────────────────────────
정책            P-036 휴면 챌린지 정책
테스트 내용     모든 멤버 자동 탈퇴
기대결과        challenges.balance → 시스템 귀속
검증항목        1. 잔액 우리두 귀속


================================================================================
4. 권한 테스트 (21개)
================================================================================

TC-PERM-001: PM-001 리더 챌린지 정보 전체 권한
──────────────────────────────────────────────────────────────────────────────
권한            PM-001
역할            리더
테스트 내용     챌린지 정보 CRUD
기대결과        모두 성공
검증항목        1. 보기/수정/삭제/쓰기 가능

TC-PERM-002: PM-002 팔로워 챌린지 정보 보기만
──────────────────────────────────────────────────────────────────────────────
권한            PM-002
역할            팔로워
테스트 내용     챌린지 수정 시도
기대결과        403 Forbidden
검증항목        1. 보기만 가능

TC-PERM-003: PM-003 비회원 공개 정보만 보기
──────────────────────────────────────────────────────────────────────────────
권한            PM-003
역할            비회원
테스트 내용     공개 챌린지 조회
기대결과        200 OK
검증항목        1. is_public = 'Y'만 조회

TC-PERM-004: PM-004 리더 공지사항 핀 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-004
역할            리더
테스트 내용     게시글 is_pinned = 'Y' 설정
기대결과        200 OK
검증항목        1. 공지사항 핀 가능

TC-PERM-005: PM-005 팔로워 본인 게시글만 수정/삭제
──────────────────────────────────────────────────────────────────────────────
권한            PM-005
역할            팔로워
테스트 내용     타인 게시글 수정 시도
기대결과        403 Forbidden
검증항목        1. 본인 게시글만 가능

TC-PERM-006: PM-006 비회원 피드 접근 불가
──────────────────────────────────────────────────────────────────────────────
권한            PM-006
역할            비회원
테스트 내용     피드 조회 시도
기대결과        401 Unauthorized
검증항목        1. 인증 필요

TC-PERM-007: PM-007 리더 투표 생성/관리 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-007
역할            리더
테스트 내용     투표 생성
기대결과        201 Created
검증항목        1. 투표 생성 가능

TC-PERM-008: PM-008 팔로워 투표 참여만 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-008
역할            팔로워
테스트 내용     투표 생성 시도
기대결과        403 Forbidden
검증항목        1. 투표 참여만 가능

TC-PERM-009: PM-009 리더 모임 투표 생성 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-009
역할            리더
테스트 내용     MEETING_ATTENDANCE 투표 생성
기대결과        201 Created
검증항목        1. 모임 투표 생성 가능

TC-PERM-010: PM-010 팔로워 참석/불참 투표 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-010
역할            팔로워
테스트 내용     참석 의사 표시
기대결과        200 OK
검증항목        1. AGREE/DISAGREE 투표 가능

TC-PERM-011: PM-011 권한박탈 모임 투표 불가
──────────────────────────────────────────────────────────────────────────────
권한            PM-011
역할            권한박탈
테스트 내용     모임 참석 투표 시도
기대결과        403 Forbidden
검증항목        1. 보기만 가능

TC-PERM-012: PM-012 리더 장부 메모 수정 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-012
역할            리더
테스트 내용     장부 메모 수정
기대결과        200 OK
검증항목        1. memo 수정 가능

TC-PERM-013: PM-013 팔로워 장부 보기만
──────────────────────────────────────────────────────────────────────────────
권한            PM-013
역할            팔로워
테스트 내용     장부 수정 시도
기대결과        403 Forbidden
검증항목        1. 보기만 가능

TC-PERM-014: PM-014 리더 강퇴 투표 생성 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-014
역할            리더
테스트 내용     KICK 투표 생성
기대결과        201 Created
검증항목        1. 강퇴 투표 생성 가능

TC-PERM-015: PM-015 팔로워 멤버 목록 보기만
──────────────────────────────────────────────────────────────────────────────
권한            PM-015
역할            팔로워
테스트 내용     멤버 강퇴 시도
기대결과        403 Forbidden
검증항목        1. 보기만 가능

TC-PERM-016: PM-016 팔로워 모임 참석 등록 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-016
역할            팔로워
테스트 내용     모임 참석 등록
기대결과        200 OK
검증항목        1. 참석 등록 가능

TC-PERM-017: PM-017 권한박탈 모임 참석 불가
──────────────────────────────────────────────────────────────────────────────
권한            PM-017
역할            권한박탈
테스트 내용     모임 참석 시도
기대결과        403 Forbidden
검증항목        1. 참석 불가

TC-PERM-018: PM-018 참석자 모임 지출 투표 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-018
역할            참석자
테스트 내용     모임 관련 지출 투표
기대결과        200 OK
검증항목        1. 참석자만 투표 가능

TC-PERM-019: PM-019 미참석자 지출 투표 불가
──────────────────────────────────────────────────────────────────────────────
권한            PM-019
역할            미참석자
테스트 내용     모임 관련 지출 투표 시도
기대결과        403 Forbidden
검증항목        1. 보기만 가능

TC-PERM-020: PM-020 팔로워 리더 강퇴 요청 (30일 미활동)
──────────────────────────────────────────────────────────────────────────────
권한            PM-020
역할            팔로워
테스트 내용     리더 30일 미활동 시 LEADER_KICK 발의
기대결과        201 Created
검증항목        1. 30일 미활동 조건 충족 시 가능

TC-PERM-021: PM-021 유예상태 7일 내 모임 참여 가능
──────────────────────────────────────────────────────────────────────────────
권한            PM-021
역할            유예상태
테스트 내용     권한 박탈 후 7일 내 모임 참석
기대결과        200 OK
검증항목        1. 7일 내 참여 가능
                2. 7일 경과 시 자동 제외


================================================================================
5. E2E 플로우 테스트 (10개)
================================================================================

TC-E2E-001: 회원가입 → 로그인 → 챌린지 가입 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        신규 사용자 챌린지 가입
단계            1. POST /auth/signup
                2. POST /auth/login
                3. POST /accounts/charge (100,000원)
                4. GET /challenges (목록 조회)
                5. POST /challenges/{id}/join
검증항목        1. 사용자 생성
                2. 토큰 발급
                3. 잔액 충전
                4. 챌린지 가입 완료
                5. 멤버 목록에 추가

TC-E2E-002: 챌린지 생성 → 멤버 모집 → ACTIVE 전환 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        챌린지 생성 및 활성화
단계            1. POST /challenges (리더)
                2. POST /challenges/{id}/join (유저A)
                3. POST /challenges/{id}/join (유저B)
검증항목        1. status = 'RECRUITING' (1~2명)
                2. 3명 도달 시 status = 'IN_PROGRESS'
                3. 전체 멤버 보증금 락

TC-E2E-003: 모임 생성 → 투표 → 확정 → 완료 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        정기 모임 전체 플로우
단계            1. POST /challenges/{id}/meetings (리더)
                2. POST /meetings/{id}/attendance (멤버들)
                3. 과반수 AGREE → status = 'CONFIRMED'
                4. POST /meetings/{id}/complete (리더)
검증항목        1. 모임 생성
                2. 투표 진행
                3. 과반수 도달 시 확정
                4. 참석자 점수 반영

TC-E2E-004: 지출 요청 → 투표 → 바코드 발급 → 결제 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        지출 결제 전체 플로우
단계            1. POST /challenges/{id}/expenses (리더)
                2. PUT /expenses/{id}/vote (참석자들)
                3. 과반수 승인 → status = 'APPROVED'
                4. POST /expenses/{id}/execute
                5. PG 결제 → Webhook → 장부 기록
검증항목        1. 지출 요청 생성
                2. 참석자만 투표
                3. 바코드 발급 (10분 유효)
                4. 결제 완료 시 장부 자동 기록

TC-E2E-005: 보증금 충당 → 권한 박탈 → 복구 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        보증금 안심결제 플로우
단계            1. balance = 0 상태에서 서포트 납입일 도래
                2. lockedBalance에서 차감
                3. privilege_status = 'REVOKED'
                4. POST /accounts/charge (충전)
                5. privilege_status = 'ACTIVE'
검증항목        1. 보증금 충당
                2. 즉시 권한 박탈
                3. 충전 시 보증금 우선 복구
                4. 권한 자동 복구

TC-E2E-006: 60일 미충전 → 자동 탈퇴 → 보증금 몰수 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        자동 탈퇴 플로우
단계            1. 보증금 충당 발생
                2. 60일 미충전
                3. 배치 실행 → 자동 탈퇴
검증항목        1. leave_reason = 'AUTO_LEAVE'
                2. lockedBalance 몰수
                3. 리더에게 알림

TC-E2E-007: 리더 미활동 → 강퇴 투표 → 승계 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        리더 탄핵 플로우
단계            1. 리더 30일 미활동
                2. POST /challenges/{id}/votes (LEADER_KICK)
                3. 70% 승인
                4. 당도 최고자 리더 승계
검증항목        1. 30일 미활동 조건
                2. 70% 승인 필요
                3. 점수 최고자 승계
                4. 기존 리더 FOLLOWER 전환

TC-E2E-008: 챌린지 종료 → 정산 → 잔액 분배 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        챌린지 정산 플로우
단계            1. POST /challenges/{id}/votes (DISSOLVE)
                2. 100% 동의
                3. status = 'COMPLETED'
                4. POST /challenges/{id}/settle
검증항목        1. 전원 동의 필요
                2. 잔액 N등분
                3. 각 멤버 balance 증가

TC-E2E-009: SNS 피드 작성 → 좋아요 → 댓글 → 대댓글 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        SNS 상호작용 플로우
단계            1. POST /challenges/{id}/posts
                2. POST /posts/{id}/like
                3. POST /posts/{id}/comments
                4. POST /posts/{id}/comments (parentId 포함)
검증항목        1. 게시글 생성
                2. 좋아요 카운트 증가
                3. 댓글 카운트 증가
                4. 알림 발송

TC-E2E-010: 검색 → 추천 → 가입 → 활동 플로우
──────────────────────────────────────────────────────────────────────────────
시나리오        Django 통합 플로우
단계            1. GET /search?q=저축
                2. GET /recommendations/challenges
                3. POST /challenges/{id}/join
                4. GET /analytics/user/activity
검증항목        1. Elasticsearch 검색
                2. ML 기반 추천
                3. 챌린지 가입
                4. 활동 통계 반영


================================================================================
6. 경계값/예외 테스트 (15개)
================================================================================

TC-BNDRY-001: 비밀번호 최소 길이 (8자)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     password = "Test123" (7자)
기대결과        400 Bad Request
검증항목        1. 8자 미만 거부

TC-BNDRY-002: 비밀번호 최대 길이 (20자)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     password = "Test1234567890123456!" (21자)
기대결과        400 Bad Request
검증항목        1. 20자 초과 거부

TC-BNDRY-003: 닉네임 최소 길이 (2자)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     nickname = "김" (1자)
기대결과        400 Bad Request
검증항목        1. 2자 미만 거부

TC-BNDRY-004: 닉네임 최대 길이 (20자)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     nickname = "가나다라마바사아자차카타파하가나다라마바사" (21자)
기대결과        400 Bad Request
검증항목        1. 20자 초과 거부

TC-BNDRY-005: 충전 최소 금액 (10,000원)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     amount = 9,999
기대결과        400 Bad Request
검증항목        1. 10,000원 미만 거부

TC-BNDRY-006: 충전 최대 금액 (1,000,000원)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     amount = 1,000,001
기대결과        400 Bad Request
검증항목        1. 1,000,000원 초과 거부

TC-BNDRY-007: 챌린지 최소 인원 (3명)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     minFollowers = 2
기대결과        400 Bad Request
검증항목        1. 최소 3명 필요

TC-BNDRY-008: 투표 마감 최소 시간 (24시간)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     expiresAt = NOW + 23시간
기대결과        400 Bad Request
검증항목        1. 최소 24시간 이후

TC-BNDRY-009: 바코드 유효 시간 (10분)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     바코드 발급 후 10분 1초 경과
기대결과        status = 'EXPIRED'
검증항목        1. 10분 초과 시 만료

TC-BNDRY-010: 파일 최대 크기 (10MB)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     11MB 이미지 업로드
기대결과        400 Bad Request
                FILE_002: 파일 크기 초과
검증항목        1. 10MB 초과 거부

TC-BNDRY-011: 검색어 최소 길이 (2자)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     q = "가" (1자)
기대결과        400 Bad Request
                SEARCH_001: 검색어는 2자 이상
검증항목        1. 2자 미만 거부

TC-BNDRY-012: 로그인 실패 5회 계정 잠금
──────────────────────────────────────────────────────────────────────────────
테스트 내용     잘못된 비밀번호 5회 시도
기대결과        계정 잠금 (30분)
검증항목        1. locked_until 설정
                2. 6회째 시도 시 403

TC-BNDRY-013: 신고 20회 자동 정지
──────────────────────────────────────────────────────────────────────────────
테스트 내용     20명이 동일 사용자 신고
기대결과        account_status = 'SUSPENDED'
검증항목        1. 자동 정지 처리

TC-BNDRY-014: 리더 챌린지 생성 한도 (3개)
──────────────────────────────────────────────────────────────────────────────
테스트 내용     4번째 챌린지 생성 시도
기대결과        400 Bad Request
                CHALLENGE_007: 한도 초과
검증항목        1. 3개 초과 생성 불가

TC-BNDRY-015: 동시 투표 방지
──────────────────────────────────────────────────────────────────────────────
테스트 내용     동일 유형 투표 진행 중 새 투표 생성
기대결과        409 Conflict
                VOTE_004: 이미 진행 중
검증항목        1. 동일 유형 중복 투표 방지


================================================================================
변경 이력
================================================================================

버전      일자          작성자      변경 내용
──────    ──────────    ────────    ─────────────────────────────
1.0.0     2026-01-16    System      초기 버전 생성
                                    - API 단위 테스트 92개
                                    - 정책 테스트 61개
                                    - 권한 테스트 21개
                                    - E2E 플로우 테스트 10개
                                    - 경계값/예외 테스트 15개


================================================================================
                              END OF DOCUMENT
================================================================================